const Yo="modulepreload",Xo=function(e){return"/extensions/ComfyUI-Mape-Helpers/tweak/"+e},pi={},lt=function(t,n,i){let o=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link");o=Promise.all(n.map(r=>{if(r=Xo(r),r in pi)return;pi[r]=!0;const l=r.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(!!i)for(let p=s.length-1;p>=0;p--){const f=s[p];if(f.href===r&&(!l||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${c}`))return;const a=document.createElement("link");if(a.rel=l?"stylesheet":Yo,l||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),l)return new Promise((p,f)=>{a.addEventListener("load",p),a.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})}))}return o.then(()=>t()).catch(s=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=s,window.dispatchEvent(r),!r.defaultPrevented)throw s})},Jo=(e,t)=>e===t,qe=Symbol("solid-proxy"),Bn=Symbol("solid-track"),Zt={equals:Jo};let Fi=Wi;const Ke=1,Qt=2,Ki={owned:null,cleanups:null,context:null,owner:null};var se=null;let kn=null,qo=null,de=null,_e=null,Le=null,pn=0;function Vt(e,t){const n=de,i=se,o=e.length===0,s=t===void 0?i:t,r=o?Ki:{owned:null,cleanups:null,context:s?s.context:null,owner:s},l=o?e:()=>e(()=>Re(()=>hn(r)));se=r,de=null;try{return gt(l,!0)}finally{de=n,se=i}}function ee(e,t){t=t?Object.assign({},Zt,t):Zt;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},i=o=>(typeof o=="function"&&(o=o(n.value)),Gi(n,o));return[Vi.bind(n),i]}function X(e,t,n){const i=si(e,t,!1,Ke);Ht(i)}function Ae(e,t,n){Fi=os;const i=si(e,t,!1,Ke),o=hi&&es(hi);o&&(i.suspense=o),(!n||!n.render)&&(i.user=!0),Le?Le.push(i):Ht(i)}function le(e,t,n){n=n?Object.assign({},Zt,n):Zt;const i=si(e,t,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=n.equals||void 0,Ht(i),Vi.bind(i)}function Zo(e){return gt(e,!1)}function Re(e){if(de===null)return e();const t=de;de=null;try{return e()}finally{de=t}}function at(e){Ae(()=>Re(e))}function jt(e){return se===null||(se.cleanups===null?se.cleanups=[e]:se.cleanups.push(e)),e}function Un(){return de}function Qo(){return se}function es(e){return se&&se.context&&se.context[e.id]!==void 0?se.context[e.id]:e.defaultValue}function ts(e){const t=le(e),n=le(()=>Fn(t()));return n.toArray=()=>{const i=n();return Array.isArray(i)?i:i!=null?[i]:[]},n}let hi;function Vi(){if(this.sources&&this.state)if(this.state===Ke)Ht(this);else{const e=_e;_e=null,gt(()=>tn(this),!1),_e=e}if(de){const e=this.observers?this.observers.length:0;de.sources?(de.sources.push(this),de.sourceSlots.push(e)):(de.sources=[this],de.sourceSlots=[e]),this.observers?(this.observers.push(de),this.observerSlots.push(de.sources.length-1)):(this.observers=[de],this.observerSlots=[de.sources.length-1])}return this.value}function Gi(e,t,n){let i=e.value;return(!e.comparator||!e.comparator(i,t))&&(e.value=t,e.observers&&e.observers.length&&gt(()=>{for(let o=0;o<e.observers.length;o+=1){const s=e.observers[o],r=kn&&kn.running;r&&kn.disposed.has(s),(r?!s.tState:!s.state)&&(s.pure?_e.push(s):Le.push(s),s.observers&&Yi(s)),r||(s.state=Ke)}if(_e.length>1e6)throw _e=[],new Error},!1)),t}function Ht(e){if(!e.fn)return;hn(e);const t=pn;ns(e,e.value,t)}function ns(e,t,n){let i;const o=se,s=de;de=se=e;try{i=e.fn(t)}catch(r){return e.pure&&(e.state=Ke,e.owned&&e.owned.forEach(hn),e.owned=null),e.updatedAt=n+1,Xi(r)}finally{de=s,se=o}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?Gi(e,i):e.value=i,e.updatedAt=n)}function si(e,t,n,i=Ke,o){const s={fn:e,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:se,context:se?se.context:null,pure:n};return se===null||se!==Ki&&(se.owned?se.owned.push(s):se.owned=[s]),s}function en(e){if(e.state===0)return;if(e.state===Qt)return tn(e);if(e.suspense&&Re(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<pn);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===Ke)Ht(e);else if(e.state===Qt){const i=_e;_e=null,gt(()=>tn(e,t[0]),!1),_e=i}}function gt(e,t){if(_e)return e();let n=!1;t||(_e=[]),Le?n=!0:Le=[],pn++;try{const i=e();return is(n),i}catch(i){n||(Le=null),_e=null,Xi(i)}}function is(e){if(_e&&(Wi(_e),_e=null),e)return;const t=Le;Le=null,t.length&&gt(()=>Fi(t),!1)}function Wi(e){for(let t=0;t<e.length;t++)en(e[t])}function os(e){let t,n=0;for(t=0;t<e.length;t++){const i=e[t];i.user?e[n++]=i:en(i)}for(t=0;t<n;t++)en(e[t])}function tn(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const i=e.sources[n];if(i.sources){const o=i.state;o===Ke?i!==t&&(!i.updatedAt||i.updatedAt<pn)&&en(i):o===Qt&&tn(i,t)}}}function Yi(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=Qt,n.pure?_e.push(n):Le.push(n),n.observers&&Yi(n))}}function hn(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),i=e.sourceSlots.pop(),o=n.observers;if(o&&o.length){const s=o.pop(),r=n.observerSlots.pop();i<o.length&&(s.sourceSlots[r]=i,o[i]=s,n.observerSlots[i]=r)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)hn(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function ss(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Xi(e,t=se){throw ss(e)}function Fn(e){if(typeof e=="function"&&!e.length)return Fn(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const i=Fn(e[n]);Array.isArray(i)?t.push.apply(t,i):t.push(i)}return t}return e}const rs=Symbol("fallback");function gi(e){for(let t=0;t<e.length;t++)e[t]()}function ls(e,t,n={}){let i=[],o=[],s=[],r=0,l=t.length>1?[]:null;return jt(()=>gi(s)),()=>{let c=e()||[],u,a;return c[Bn],Re(()=>{let f=c.length,h,g,d,w,b,A,y,$,k;if(f===0)r!==0&&(gi(s),s=[],i=[],o=[],r=0,l&&(l=[])),n.fallback&&(i=[rs],o[0]=Vt(j=>(s[0]=j,n.fallback())),r=1);else if(r===0){for(o=new Array(f),a=0;a<f;a++)i[a]=c[a],o[a]=Vt(p);r=f}else{for(d=new Array(f),w=new Array(f),l&&(b=new Array(f)),A=0,y=Math.min(r,f);A<y&&i[A]===c[A];A++);for(y=r-1,$=f-1;y>=A&&$>=A&&i[y]===c[$];y--,$--)d[$]=o[y],w[$]=s[y],l&&(b[$]=l[y]);for(h=new Map,g=new Array($+1),a=$;a>=A;a--)k=c[a],u=h.get(k),g[a]=u===void 0?-1:u,h.set(k,a);for(u=A;u<=y;u++)k=i[u],a=h.get(k),a!==void 0&&a!==-1?(d[a]=o[u],w[a]=s[u],l&&(b[a]=l[u]),a=g[a],h.set(k,a)):s[u]();for(a=A;a<f;a++)a in d?(o[a]=d[a],s[a]=w[a],l&&(l[a]=b[a],l[a](a))):o[a]=Vt(p);o=o.slice(0,r=f),i=c.slice(0)}return o});function p(f){if(s[a]=f,l){const[h,g]=ee(a);return l[a]=g,t(c[a],h)}return t(c[a])}}}let as=!1;function he(e,t){return Re(()=>e(t||{}))}const cs=e=>`Stale read from <${e}>.`;function Ji(e){const t="fallback"in e&&{fallback:()=>e.fallback};return le(ls(()=>e.each,e.children,t||void 0))}function qi(e){let t=!1;const n=(s,r)=>(t?s[1]===r[1]:!s[1]==!r[1])&&s[2]===r[2],i=ts(()=>e.children),o=le(()=>{let s=i();Array.isArray(s)||(s=[s]);for(let r=0;r<s.length;r++){const l=s[r].when;if(l)return t=!!s[r].keyed,[r,l,s[r]]}return[-1]},void 0,{equals:n});return le(()=>{const[s,r,l]=o();if(s<0)return e.fallback;const c=l.children;return typeof c=="function"&&c.length>0?Re(()=>c(t?r:()=>{if(Re(o)[0]!==s)throw cs("Match");return l.when})):c},void 0,void 0)}function Xe(e){return e}function us(e,t,n){let i=n.length,o=t.length,s=i,r=0,l=0,c=t[o-1].nextSibling,u=null;for(;r<o||l<s;){if(t[r]===n[l]){r++,l++;continue}for(;t[o-1]===n[s-1];)o--,s--;if(o===r){const a=s<i?l?n[l-1].nextSibling:n[s-l]:c;for(;l<s;)e.insertBefore(n[l++],a)}else if(s===l)for(;r<o;)(!u||!u.has(t[r]))&&t[r].remove(),r++;else if(t[r]===n[s-1]&&n[l]===t[o-1]){const a=t[--o].nextSibling;e.insertBefore(n[l++],t[r++].nextSibling),e.insertBefore(n[--s],a),t[o]=n[s]}else{if(!u){u=new Map;let p=l;for(;p<s;)u.set(n[p],p++)}const a=u.get(t[r]);if(a!=null)if(l<a&&a<s){let p=r,f=1,h;for(;++p<o&&p<s&&!((h=u.get(t[p]))==null||h!==a+f);)f++;if(f>a-l){const g=t[r];for(;l<a;)e.insertBefore(n[l++],g)}else e.replaceChild(n[l++],t[r++])}else r++;else t[r++].remove()}}}const mi="_$DX_DELEGATE";function Zi(e,t,n,i={}){let o;return Vt(s=>{o=s,t===document?e():U(t,e(),t.firstChild?null:void 0,n)},i.owner),()=>{o(),t.textContent=""}}function G(e,t,n){let i;const o=()=>{const r=document.createElement("template");return r.innerHTML=e,n?r.content.firstChild.firstChild:r.content.firstChild},s=t?()=>Re(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function tt(e,t=window.document){const n=t[mi]||(t[mi]=new Set);for(let i=0,o=e.length;i<o;i++){const s=e[i];n.has(s)||(n.add(s),t.addEventListener(s,fs))}}function ge(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function ds(e,t){t==null?e.removeAttribute("class"):e.className=t}function ri(e,t,n,i){if(i)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const o=n[0];e.addEventListener(t,n[0]=s=>o.call(e,n[1],s))}else e.addEventListener(t,n)}function kt(e,t,n){return Re(()=>e(t,n))}function U(e,t,n,i){if(n!==void 0&&!i&&(i=[]),typeof t!="function")return nn(e,t,i,n);X(o=>nn(e,t(),o,n),i)}function fs(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}});n;){const i=n[t];if(i&&!n.disabled){const o=n[`${t}Data`];if(o!==void 0?i.call(n,o,e):i.call(n,e),e.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function nn(e,t,n,i,o){for(;typeof n=="function";)n=n();if(t===n)return n;const s=typeof t,r=i!==void 0;if(e=r&&n[0]&&n[0].parentNode||e,s==="string"||s==="number")if(s==="number"&&(t=t.toString()),r){let l=n[0];l&&l.nodeType===3?l.data!==t&&(l.data=t):l=document.createTextNode(t),n=nt(e,n,i,l)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t;else if(t==null||s==="boolean")n=nt(e,n,i);else{if(s==="function")return X(()=>{let l=t();for(;typeof l=="function";)l=l();n=nn(e,l,n,i)}),()=>n;if(Array.isArray(t)){const l=[],c=n&&Array.isArray(n);if(Kn(l,t,n,o))return X(()=>n=nn(e,l,n,i,!0)),()=>n;if(l.length===0){if(n=nt(e,n,i),r)return n}else c?n.length===0?vi(e,l,i):us(e,n,l):(n&&nt(e),vi(e,l));n=l}else if(t.nodeType){if(Array.isArray(n)){if(r)return n=nt(e,n,i,t);nt(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Kn(e,t,n,i){let o=!1;for(let s=0,r=t.length;s<r;s++){let l=t[s],c=n&&n[s],u;if(!(l==null||l===!0||l===!1))if((u=typeof l)=="object"&&l.nodeType)e.push(l);else if(Array.isArray(l))o=Kn(e,l,c)||o;else if(u==="function")if(i){for(;typeof l=="function";)l=l();o=Kn(e,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||o}else e.push(l),o=!0;else{const a=String(l);c&&c.nodeType===3&&c.data===a?e.push(c):e.push(document.createTextNode(a))}}return o}function vi(e,t,n=null){for(let i=0,o=t.length;i<o;i++)e.insertBefore(t[i],n)}function nt(e,t,n,i){if(n===void 0)return e.textContent="";const o=i||document.createTextNode("");if(t.length){let s=!1;for(let r=t.length-1;r>=0;r--){const l=t[r];if(o!==l){const c=l.parentNode===e;!s&&!r?c?e.replaceChild(o,l):e.insertBefore(o,n):c&&l.remove()}else s=!0}}else e.insertBefore(o,n);return[o]}const ps=async()=>{const{ImagePreviews:e}=await lt(()=>Promise.resolve().then(()=>Cs),void 0),t=document.createElement("div");document.body.appendChild(t),Zi(()=>he(e,{}),t)},hs=async()=>{const{registerPlugin:e}=await lt(()=>Promise.resolve().then(()=>hr),void 0);e(),async function t(){if(typeof app>"u"){setTimeout(t);return}const{MapeTweak:n}=await lt(()=>Promise.resolve().then(()=>Bl),void 0),i=document.createElement("div");document.body.appendChild(i),Zi(()=>he(n,{}),i)}()};window.standaloneImagePreview?ps():hs();function ie(e){let t=e.type;return e.IS_MAPE_VARIABLE?!0:(t===void 0&&(t=e.comfyClass),t?t.startsWith(Me):!1)}const ct=e=>{var t,n,i;return ie(e)&&((i=(n=(t=e.outputs)==null?void 0:t[0])==null?void 0:n.links)==null?void 0:i.length)},be=e=>{var t,n;return ie(e)&&((n=(t=e.inputs)==null?void 0:t[0])==null?void 0:n.link)},Ft="mape_tweak_",gs="mape_imagepreview_",Me="mape Variable",ms="*",oe=e=>graph.getNodeById(e),Pe=()=>graph._nodes,gn=()=>Pe().filter(ie),Qi=()=>gn().filter(be),eo=()=>graph._groups,vs=()=>{var e;return(e=Ye())==null?void 0:e[0]},Ye=()=>Object.values(graph.list_of_graphcanvas[0].selected_nodes),Be=e=>e?`/view?filename=${e.filename}&subfolder=${e.subfolder}&type=${e.type}&rand=42`:void 0,Vn=(e,t,n,i)=>{const o=n-e,s=i-t;return Math.sqrt(o**2+s**2)},to=e=>{const t=Object.fromEntries(Object.values(e).map(s=>[s.name,s.pos??[0,0]])),n=Math.min(...Object.values(t).map(([s,r])=>s)),i=Math.min(...Object.values(t).map(([s,r])=>r)),o=Object.fromEntries(Object.entries(t).map(([s,[r,l]])=>[s,Vn(n,i,r,l)]));return(s,r)=>o[s.name]-o[r.name]},ys=(e,t,n=.35)=>{let i=1,o=1,s=1,r=1,l=1,c=1,u=1;const a=e[0],p=e[1],f=p/a;for(let h=1;h<=t;h++){const g=h,d=Math.ceil(t/g);d/g*n>f?(u=Math.floor(p/d),c=Math.floor(u/n)):(c=Math.floor(a/g),u=Math.floor(c*n));const w=c*u*t;(i===void 0||w>i)&&(i=w,r=u,l=c,o=g,s=d)}return{targetCols:o,targetRows:s,targetHeight:r,targetWidth:l}};var _s=G("<div class=imagePreviews>"),bs=G("<div class=imagePreviewTweaks><label>Image Previews</label><label>Display type"),yi=G("<img class=fullImage>"),$s=G("<div class=mosaicGrid><div class=inner>"),ws=G('<div class=flipbookFps><label for="">FPS</label><input type=number step=1 min=1 max=120><label for=flipflop title="Reverse at end of clip instead of restarting">Flip Flop</label><input id=flipflop type=checkbox>'),ks=G("<div class=content><div class=bigPreview><div class=zoom>x"),_i=G("<div class=button>"),xs=G("<div class=thumbnails>"),Ss=G("<div class=thumb><img class=smallImage>"),As=G("<div class=mosaicImage><img class=smallImage>");const xt="mape_image_previews",xn=`${gs}FPS`,Es=()=>{const[e,t]=ee(1),[n,i]=ee([0,0]),[o,s]=ee(0),[r,l]=ee("images"),[c,u]=ee({}),[a,p]=ee(localStorage.mapeImageDisplayType??"single");let f;Ae(()=>{r(),g(0)});const[h,g]=ee(0),[d,w]=ee(localStorage[xn]?JSON.parse(localStorage[xn]):{}),[b,A]=ee(!!localStorage.mape_tweak_flipflop);Ae(()=>{localStorage[xn]=JSON.stringify(d())}),Ae(()=>{b()?localStorage.mape_tweak_flipflop=!0:delete localStorage.mape_tweak_flipflop});let y=1;const $=()=>{if(clearTimeout(f),a()==="flipbook"){if(f=setTimeout($,1e3/(d()[r()]??12)),!j()||!j().value){g(0);return}const _=j().value.length;if(_===1){g(0);return}if(b()){const E=h()+y;(E<0||E>=_)&&(y=-y);const C=h()+y;g(C)}else{let E=h()+1;E>=_&&(E=0),g(E)}}};jt(()=>{clearTimeout(f)}),Ae(()=>{localStorage.mapeImageDisplayType=a(),g(0),y=1,a()==="flipbook"&&(g(0),setTimeout($))}),localStorage[xt]&&u(JSON.parse(localStorage[xt]));function k(_){const{key:E,newValue:C}=_;E===xt&&C&&(u(JSON.parse(C)),j()||l(Object.keys(c())[0]??""),j()&&j().value&&j().value.length<=o()&&s(0))}window.addEventListener("storage",k);const j=()=>c()[r()],R=()=>`scale(${m()}) translate(calc(-50% + ${n()[0]}px), calc(-50% + ${n()[1]}px))`;let L;const[B,q]=ee([100,100]);Ae(()=>{a(),L&&q([L.clientWidth,L.clientHeight])}),window.addEventListener("resize",()=>{L&&q([L.clientWidth,L.clientHeight])});const[I,x]=ee(1),[T,D]=ee([1,1]);Ae(()=>{const _=F()[0];if(!_)return;const E=Be(_),C=new Image;C.addEventListener("load",()=>{x(C.height/C.width),D([C.width,C.height])}),C.src=E});const M=()=>{const _=ys(B(),F().length,I()),E=_.targetHeight*_.targetRows,C=_.targetWidth*_.targetCols;return{imageWidth:Math.min(T()[0],_.targetWidth),imageHeight:Math.min(T()[1],_.targetHeight),containerHeight:E,containerWidth:C,ratio:Math.min(1,Math.max(_.targetWidth,_.targetHeight)/Math.max(...T()))}},P=(_=!1)=>{s(0),_&&(i([0,0]),t(1))},F=()=>(j()??{}).value??[],v=_=>Math.pow(_,2.5),m=()=>v(e());return(()=>{var _=_s();return U(_,(()=>{var E=le(()=>!!j());return()=>E()?[(()=>{var C=bs(),H=C.firstChild,N=H.nextSibling;return U(C,()=>Object.values(c()).sort(to(c())).map(z=>(()=>{var S=_i();return S.$$click=()=>{P(),s(0),l(z.name)},U(S,()=>z.name),X(()=>S.classList.toggle("active",z.name===r())),S})()),N),U(C,()=>[{id:"single",text:"Single image"},{id:"mosaic",text:"Grid view"},{id:"flipbook",text:"Flipbook"}].map(z=>(()=>{var S=_i();return S.$$click=()=>{P(),p(z.id)},U(S,()=>z.text),X(()=>S.classList.toggle("active",a()===z.id)),S})()),null),C})(),(()=>{var C=ks(),H=C.firstChild,N=H.firstChild,z=N.firstChild;return U(C,(()=>{var S=le(()=>a()==="single"&&F().length>1);return()=>S()?(()=>{var J=xs();return U(J,()=>F().map((K,V)=>(()=>{var O=Ss(),W=O.firstChild;return O.$$click=()=>{s(V)},X(Z=>{var Q=V===o(),me=Be(K);return Q!==Z.e&&O.classList.toggle("active",Z.e=Q),me!==Z.t&&ge(W,"src",Z.t=me),Z},{e:void 0,t:void 0}),O})())),J})():null})(),H),H.addEventListener("wheel",S=>{const J=L.getClientRects()[0],[K,V]=[S.clientX,S.clientY],{x:O,y:W,width:Z,height:Q}=J,me=(K-O)/Z,Ee=(V-W)/Q;t(Math.max(.1,e()-(S.deltaY>0?.075:-.075))),(()=>{i([0,0]);const Oe=L.getClientRects()[0],{x:vt,y:Bo,width:di,height:fi}=Oe,Uo=(K-vt)/di,Fo=(V-Bo)/fi,Ko=Uo-me,Vo=Fo-Ee,Go=Ko*di/m(),Wo=Vo*fi/m();i([n()[0]+Go,n()[1]+Wo])})()}),H.$$mousedown=S=>{const J=S.clientX,K=S.clientY,[V,O]=n(),W=Q=>{Q.preventDefault();const me=Q.clientX,Ee=Q.clientY,Oe=J-me,vt=K-Ee;i([V-Oe/m(),O-vt/m()])},Z=()=>{document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",Z)};document.addEventListener("mousemove",W),document.addEventListener("mouseup",Z)},H.$$dblclick=()=>{P(!0)},U(H,he(qi,{get children(){return[he(Xe,{get when(){return a()==="single"},get children(){var S=yi(),J=L;return typeof J=="function"?kt(J,S):L=S,X(K=>{var V=R(),O=Be((j().value??[])[o()]);return V!==K.e&&((K.e=V)!=null?S.style.setProperty("transform",V):S.style.removeProperty("transform")),O!==K.t&&ge(S,"src",K.t=O),K},{e:void 0,t:void 0}),S}}),he(Xe,{get when(){return a()==="mosaic"},get children(){var S=$s(),J=S.firstChild;S.$$dblclick=()=>{P(!0)};var K=L;return typeof K=="function"?kt(K,S):L=S,U(J,()=>F().map((V,O)=>(()=>{var W=As(),Z=W.firstChild;return W.$$click=()=>{s(O)},X(Q=>{var me=`${M().imageWidth}px`,Ee=`${M().imageHeight}px`,Oe=Be(V);return me!==Q.e&&((Q.e=me)!=null?W.style.setProperty("width",me):W.style.removeProperty("width")),Ee!==Q.t&&((Q.t=Ee)!=null?W.style.setProperty("height",Ee):W.style.removeProperty("height")),Oe!==Q.a&&ge(Z,"src",Q.a=Oe),Q},{e:void 0,t:void 0,a:void 0}),W})())),X(V=>{var O=R(),W=`${M().containerWidth}px`,Z=`${M().containerHeight}px`;return O!==V.e&&((V.e=O)!=null?S.style.setProperty("transform",O):S.style.removeProperty("transform")),W!==V.t&&((V.t=W)!=null?J.style.setProperty("width",W):J.style.removeProperty("width")),Z!==V.a&&((V.a=Z)!=null?J.style.setProperty("height",Z):J.style.removeProperty("height")),V},{e:void 0,t:void 0,a:void 0}),S}}),he(Xe,{get when(){return a()==="flipbook"},get children(){return[(()=>{var S=ws(),J=S.firstChild,K=J.nextSibling,V=K.nextSibling,O=V.nextSibling;return K.$$input=W=>{w({...d(),[r()]:Math.max(1,parseInt(W.currentTarget.value,10))})},O.addEventListener("change",()=>{A(!b())}),X(()=>K.value=d()[r()]??12),X(()=>O.checked=b()),S})(),(()=>{var S=yi(),J=L;return typeof J=="function"?kt(J,S):L=S,X(K=>{var V=R(),O=Be((j().value??[])[h()]);return V!==K.e&&((K.e=V)!=null?S.style.setProperty("transform",V):S.style.removeProperty("transform")),O!==K.t&&ge(S,"src",K.t=O),K},{e:void 0,t:void 0}),S})()]}})]}}),N),N.$$click=()=>{P(!0)},U(N,(()=>{var S=le(()=>a()==="mosaic");return()=>S()?parseFloat((M().ratio*m()).toFixed(2)):parseFloat(m().toFixed(2))})(),z),C})()]:null})()),X(()=>{var E,C;return _.classList.toggle("hasMultiple",((C=(E=j())==null?void 0:E.value)==null?void 0:C.length)>0)}),_})()};tt(["dblclick","mousedown","input","click"]);const Cs=Object.freeze(Object.defineProperty({__proto__:null,ImagePreviews:Es,localStoragePreviewImagesKey:xt},Symbol.toStringTag,{value:"Module"})),Gn=Symbol("store-raw"),ut=Symbol("store-node"),Te=Symbol("store-has"),no=Symbol("store-self");function io(e){let t=e[qe];if(!t&&(Object.defineProperty(e,qe,{value:t=new Proxy(e,Os)}),!Array.isArray(e))){const n=Object.keys(e),i=Object.getOwnPropertyDescriptors(e);for(let o=0,s=n.length;o<s;o++){const r=n[o];i[r].get&&Object.defineProperty(e,r,{enumerable:i[r].enumerable,get:i[r].get.bind(t)})}}return t}function Fe(e){let t;return e!=null&&typeof e=="object"&&(e[qe]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function ft(e,t=new Set){let n,i,o,s;if(n=e!=null&&e[Gn])return n;if(!Fe(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let r=0,l=e.length;r<l;r++)o=e[r],(i=ft(o,t))!==o&&(e[r]=i)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const r=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let c=0,u=r.length;c<u;c++)s=r[c],!l[s].get&&(o=e[s],(i=ft(o,t))!==o&&(e[s]=i))}return e}function on(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function Ot(e,t,n){if(e[t])return e[t];const[i,o]=ee(n,{equals:!1,internal:!0});return i.$=o,e[t]=i}function Ps(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===qe||t===ut||(delete n.value,delete n.writable,n.get=()=>e[qe][t]),n}function oo(e){Un()&&Ot(on(e,ut),no)()}function js(e){return oo(e),Reflect.ownKeys(e)}const Os={get(e,t,n){if(t===Gn)return e;if(t===qe)return n;if(t===Bn)return oo(e),n;const i=on(e,ut),o=i[t];let s=o?o():e[t];if(t===ut||t===Te||t==="__proto__")return s;if(!o){const r=Object.getOwnPropertyDescriptor(e,t);Un()&&(typeof s!="function"||e.hasOwnProperty(t))&&!(r&&r.get)&&(s=Ot(i,t,s)())}return Fe(s)?io(s):s},has(e,t){return t===Gn||t===qe||t===Bn||t===ut||t===Te||t==="__proto__"?!0:(Un()&&Ot(on(e,Te),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:js,getOwnPropertyDescriptor:Ps};function Se(e,t,n,i=!1){if(!i&&e[t]===n)return;const o=e[t],s=e.length;n===void 0?(delete e[t],e[Te]&&e[Te][t]&&o!==void 0&&e[Te][t].$()):(e[t]=n,e[Te]&&e[Te][t]&&o===void 0&&e[Te][t].$());let r=on(e,ut),l;if((l=Ot(r,t,o))&&l.$(()=>n),Array.isArray(e)&&e.length!==s){for(let c=e.length;c<s;c++)(l=r[c])&&l.$();(l=Ot(r,"length",s))&&l.$(e.length)}(l=r[no])&&l.$()}function so(e,t){const n=Object.keys(t);for(let i=0;i<n.length;i+=1){const o=n[i];Se(e,o,t[o])}}function Is(e,t){if(typeof t=="function"&&(t=t(e)),t=ft(t),Array.isArray(t)){if(e===t)return;let n=0,i=t.length;for(;n<i;n++){const o=t[n];e[n]!==o&&Se(e,n,o)}Se(e,"length",i)}else so(e,t)}function wt(e,t,n=[]){let i,o=e;if(t.length>1){i=t.shift();const r=typeof i,l=Array.isArray(e);if(Array.isArray(i)){for(let c=0;c<i.length;c++)wt(e,[i[c]].concat(t),n);return}else if(l&&r==="function"){for(let c=0;c<e.length;c++)i(e[c],c)&&wt(e,[c].concat(t),n);return}else if(l&&r==="object"){const{from:c=0,to:u=e.length-1,by:a=1}=i;for(let p=c;p<=u;p+=a)wt(e,[p].concat(t),n);return}else if(t.length>1){wt(e[i],t,[i].concat(n));return}o=e[i],n=[i].concat(n)}let s=t[0];typeof s=="function"&&(s=s(o,n),s===o)||i===void 0&&s==null||(s=ft(s),i===void 0||Fe(o)&&Fe(s)&&!Array.isArray(s)?so(o,s):Se(e,i,s))}function sn(...[e,t]){const n=ft(e||{}),i=Array.isArray(n),o=io(n);function s(...r){Zo(()=>{i&&r.length===1?Is(n,r[0]):wt(n,r)})}return[o,s]}const Wn=Symbol("store-root");function it(e,t,n,i,o){const s=t[n];if(e===s)return;const r=Array.isArray(e);if(n!==Wn&&(!Fe(e)||!Fe(s)||r!==Array.isArray(s)||o&&e[o]!==s[o])){Se(t,n,e);return}if(r){if(e.length&&s.length&&(!i||o&&e[0]&&e[0][o]!=null)){let u,a,p,f,h,g,d,w;for(p=0,f=Math.min(s.length,e.length);p<f&&(s[p]===e[p]||o&&s[p]&&e[p]&&s[p][o]===e[p][o]);p++)it(e[p],s,p,i,o);const b=new Array(e.length),A=new Map;for(f=s.length-1,h=e.length-1;f>=p&&h>=p&&(s[f]===e[h]||o&&s[p]&&e[p]&&s[f][o]===e[h][o]);f--,h--)b[h]=s[f];if(p>h||p>f){for(a=p;a<=h;a++)Se(s,a,e[a]);for(;a<e.length;a++)Se(s,a,b[a]),it(e[a],s,a,i,o);s.length>e.length&&Se(s,"length",e.length);return}for(d=new Array(h+1),a=h;a>=p;a--)g=e[a],w=o&&g?g[o]:g,u=A.get(w),d[a]=u===void 0?-1:u,A.set(w,a);for(u=p;u<=f;u++)g=s[u],w=o&&g?g[o]:g,a=A.get(w),a!==void 0&&a!==-1&&(b[a]=s[u],a=d[a],A.set(w,a));for(a=p;a<e.length;a++)a in b?(Se(s,a,b[a]),it(e[a],s,a,i,o)):Se(s,a,e[a])}else for(let u=0,a=e.length;u<a;u++)it(e[u],s,u,i,o);s.length>e.length&&Se(s,"length",e.length);return}const l=Object.keys(e);for(let u=0,a=l.length;u<a;u++)it(e[l[u]],s,l[u],i,o);const c=Object.keys(s);for(let u=0,a=c.length;u<a;u++)e[c[u]]===void 0&&Se(s,c[u],void 0)}function Yn(e,t={}){const{merge:n,key:i="id"}=t,o=ft(e);return s=>{if(!Fe(s)||!Fe(o))return o;const r=it(o,{[Wn]:s},Wn,n,i);return r===void 0?s:r}}var rt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xn={},ro={};Object.defineProperty(ro,"__esModule",{value:!0});var He={},Ts=rt&&rt.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(He,"__esModule",{value:!0});He.TokenReader=He.TokenError=He.tokenizePrompt=void 0;function Ns(e){var t=[],n="",i=0,o=0,s=!1;function r(){n!==""&&(t.push([n,i]),n=""),i=o}function l(f){n+=f,o++}function c(){o++}for(var u=0,a=e.replace(/，/g,",").replace(/：/g,":").replace(/（/g,"(").replace(/）/g,")");u<a.length;u++){var p=a[u];if(s)s=!1,l(p);else switch(p){case"\\":{s=!0,l(p);break}case"(":case")":case"[":case"]":case"<":case">":case":":case",":case"|":{r(),l(p),r();break}case" ":{c(),r();break}default:l(p)}}return r(),t}He.tokenizePrompt=Ns;var Jn=function(e){Ts(t,e);function t(n,i,o){var s=e.call(this,n)||this;return s.token=i,s.position=o,s}return t}(Error);He.TokenError=Jn;var Ls=function(){function e(t){this.tokens=t,this.index=0}return e.prototype.position=function(){if(this.index<this.tokens.length)return this.tokens[this.index][1]},e.prototype.look=function(){if(this.index<this.tokens.length)return this.tokens[this.index][0]},e.prototype.lookMany=function(t){return this.tokens.slice(this.index,this.index+t).map(function(n){var i=n[0];return i})},e.prototype.next=function(){this.index<this.tokens.length&&this.index++},e.prototype.error=function(t){var n=this.look();if(n===void 0)throw new Jn("Error happened at the end of the input: ".concat(t));var i=this.position();throw new Jn("Error happened at (".concat(n,",").concat(i,"):").concat(t),n,i)},e}();He.TokenReader=Ls;var mn={};Object.defineProperty(mn,"__esModule",{value:!0});mn.parsePrompt=void 0;var Sn=He;function lo(e){return e.replace(/\\(.)/g,"$1")}function Ms(e){var t=[];e:for(;;){var n=e.look();switch(n){case"(":case")":case"[":case"]":case"<":case">":case":":case",":case"|":case void 0:break e;default:t.push(n),e.next()}}if(t.length===0)e.error("Tag expected");else return{kind:"tag",name:t.map(lo).join(" "),tokens:t}}function Hs(e){e.next();for(var t=rn(e,!1);;){var n=e.lookMany(2),i=n[0],o=n[1];if(i!==":"||!Number.isNaN(Number.parseFloat(o)))break;e.next(),t.push.apply(t,rn(e,!1))}if(e.look()===":"){e.next();var s=uo(e),r=s[0],l=s[1];return e.look()===","&&e.next(),(e.look()===")"||e.look()==="}"||e.look()===void 0)&&e.next(),{kind:"ew",weight:r,weightText:l,contents:t}}return(e.look()===")"||e.look()==="}"||e.look()===void 0)&&e.next(),{kind:"pw",contents:t}}function Rs(e){e.next();var t=rn(e,!1);return(e.look()==="]"||e.look()==="}"||e.look()===void 0)&&e.next(),{kind:"nw",contents:t}}function ao(e,t){var n=e.look();switch(n){case"(":case")":case"[":case"]":case"<":case">":case":":case",":case void 0:e.error("".concat(t," expected"));default:return lo(n)}}function zs(e){var t=ao(e,"Filename");return e.next(),t}function co(e,t){function n(a){var p=Number.parseInt(a);return!Number.isNaN(p)&&"".concat(p)===a}{var i=e.lookMany(3),o=i[0],s=i[1],r=i[2];if(n(o)&&s===","&&n(r))return e.next(),e.next(),e.next(),[Number.parseFloat("".concat(o,".").concat(r)),"".concat(o).concat(s).concat(r)]}{var l=e.lookMany(2),o=l[0],s=l[1];if(o.endsWith(".")&&n(o.substring(0,o.length-1))&&n(s))return e.next(),e.next(),[Number.parseFloat("".concat(o).concat(s)),"".concat(o," ").concat(s)]}var c=ao(e,t),u=Number.parseFloat(c);return Number.isNaN(u)&&e.error("Incorrect ".concat(t.toLowerCase()," format: ").concat(c)),e.next(),[u,c]}function uo(e){return co(e,"Weight")}function Ds(e){return co(e,"Multiplier")}function Bs(e,t){e.next(),e.next(),e.look()!==":"&&e.error('":" expected'),e.next();var n=zs(e);if(e.look()===":"){e.next();var i=Ds(e),o=i[0],s=i[1];if(e.look()===">")return e.next(),{kind:t,filename:n,multiplier:o,multiplierText:s}}if(e.look()===">")return e.next(),{kind:t,filename:n};e.next(),e.error('">" expected')}function Us(e,t){switch(e.look()){case"(":return Hs(e);case"[":return Rs(e);case"<":{var n=e.lookMany(2)[1];switch(n){case"lora":case"hypernet":return Bs(e,n);default:{e.next();return}}break}case",":e.error("Prompt expected");default:{var i=Ms(e);if(t&&e.look()===":"&&!Number.isNaN(Number.parseFloat(e.lookMany(2)[1]))){e.next();var o=uo(e),s=o[0],r=o[1];return{kind:"ew",weight:s,weightText:r,contents:[i]}}else return i}}}function rn(e,t){for(var n=[];;){var i=e.look();switch(i){case",":{e.next();break}case":":case")":case"]":case">":case"|":case void 0:return n;default:{var o=Us(e,t);o!==void 0&&n.push(o)}}}}function Fs(e){var t,n=typeof e=="string"?new Sn.TokenReader((0,Sn.tokenizePrompt)(e)):e instanceof Array?new Sn.TokenReader(e):e,i=[],o=!1;e:for(;;){o=!1;t:for(;;)switch(n.look()){case"|":{o=!0,n.next();break}case")":case"]":case">":case":":{n.next();continue e}case void 0:return i;default:break t}var s=rn(n,!0);o||i.length===0?i.push({kind:"prompt",contents:s}):(t=i[i.length-1].contents).push.apply(t,s)}}mn.parsePrompt=Fs;var vn={};Object.defineProperty(vn,"__esModule",{value:!0});vn.printPrompt=void 0;function Gt(e){for(var t="",n=!1,i=0,o=e;i<o.length;i++){var s=o[i];switch(s.kind==="tag"&&n?t+=", ":t!==""&&(t+=" "),s.kind){case"pw":{t+="(".concat(Gt(s.contents),")");break}case"nw":{t+="[".concat(Gt(s.contents),"]");break}case"ew":{t+="(".concat(Gt(s.contents),":").concat(s.weightText?s.weightText:s.weight,")");break}case"lora":case"hypernet":{t+="<".concat(s.kind,":").concat(s.filename,":").concat(s.multiplierText?s.multiplierText:s.multiplier,">");break}default:t+=s.name}n=s.kind==="tag"}return t}function Ks(e){return Gt(e.contents)}vn.printPrompt=Ks;var yn={};Object.defineProperty(yn,"__esModule",{value:!0});yn.evaluatePrompt=void 0;function Wt(e,t,n,i){for(var o,s,r=0,l=e;r<l.length;r++){var c=l[r];switch(c.kind){case"pw":{Wt(c.contents,t*n,n,i);break}case"nw":{Wt(c.contents,t/n,n,i);break}case"ew":{Wt(c.contents,t*c.weight,n,i);break}case"lora":{i.loras.push({filename:c.filename,multiplier:(o=c.multiplier)!==null&&o!==void 0?o:1});break}case"hypernet":{i.hypernets.push({filename:c.filename,multiplier:(s=c.multiplier)!==null&&s!==void 0?s:1});break}default:i.tags.push({tag:c.name,weight:t})}}}function Vs(e,t){t===void 0&&(t=1.1);var n={tags:[],loras:[],hypernets:[]};return Wt(e.contents,1,t,n),n}yn.evaluatePrompt=Vs;(function(e){var t=rt&&rt.__createBinding||(Object.create?function(i,o,s,r){r===void 0&&(r=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,r,l)}:function(i,o,s,r){r===void 0&&(r=s),i[r]=o[s]}),n=rt&&rt.__exportStar||function(i,o){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&t(o,i,s)};Object.defineProperty(e,"__esModule",{value:!0}),n(ro,e),n(He,e),n(mn,e),n(vn,e),n(yn,e)})(Xn);const St=e=>JSON.parse(JSON.stringify(e));var Gs=G('<div class=prompt><div class=arrows><div class="arrow down">▼</div></div><label><input></label><div class=weight title="Click scroll wheel button to reset to 1"></div><button class=less>- 0.05</button><input type=range step=0.05><button class=more>+ 0.05</button><button class=remove>X</button><input title="Toggle to temporarily disable"type=checkbox>'),Ws=G('<div class="arrow up">▲'),Ys=G('<div class=promptTweaker><div class=buttons><button>- 0.05 All</button><button title="Move all values 5% towards 1">Compress 5%</button><button title="Converts weights so they all add up to 1">Normalize</button><button>+ 0.05 All</button></div><div class=promptTweakerPrompts>');const Yt="🔒",Xt="🔏",Xs=e=>{const t=n=>{var i,o;return n.kind==="pw"&&(n={kind:"ew",weight:1.1,weightText:"1.1",contents:(i=n.contents)==null?void 0:i.map(t)}),n.kind==="nw"&&(n={kind:"ew",weight:.9,weightText:"0.9",contents:(o=n.contents)==null?void 0:o.map(t)}),n};return e.map(n=>(n.contents=n.contents.flatMap(i=>{const o=t(i);return fo(o)}),n))};function fo(e,t=1){if(e.contents&&e.contents.length>0)return e.contents.flatMap(n=>fo(n,t*(e.weight??1)));{const n=qn(t);return{kind:"ew",weight:n,weightText:n.toString(),contents:[e]}}}function Js(e,t,n){return e+n*(t-e)}function xe(e,t){if(e){if(typeof e[t]<"u")return e[t];if(e.contents)for(const n of e.contents){const i=xe(n,t);if(i!==void 0)return i}}}const qn=e=>parseFloat(e.toFixed(2)),qs=e=>{const[t,n]=sn([]),i=()=>{e.update([{contents:t}].map(Xn.printPrompt).join(", "))};Ae(()=>{const f=Xn.parsePrompt(e.prompt),h=Xs(f);n(h[0]?Yn(h[0].contents):[])});const o=le(()=>Math.min(...t.map(f=>f.weight??1))),s=le(()=>Math.max(...t.map(f=>f.weight??1))),r=(f,h)=>{const g=t.findIndex($=>xe($,"name")===f),d=g+h;if(d<0)return;const w=t.length;if(d===w)return;const b=St(t),A=b[g],y=b[d];b[d]=A,b[g]=y,n(Yn(b)),i()},l=f=>{for(const[h,g]of t.entries())n(h,"weight",qn(f(g.weight??-666))),n(h,"weightText",(g.weight??-666).toString());i()},c=(f,h,g="weight")=>{var w;const d=t.findIndex(b=>xe(b,"name")===f);g==="weight"?(n(d,g,qn(h(t[d][g]))),n(d,"weightText",(w=t[d].weight)==null?void 0:w.toString())):g==="name"?n(d,"contents",0,g,h(t[d][g])):alert(`Implement ${g}`),i()},u=f=>{const h=f.deltaY<0?.05:-.05;l(g=>g+h)},a=()=>{const f=t.reduce((h,g)=>h+(g.weight??0),0);l(h=>parseFloat((h/f).toFixed(3)))},p=(f,h)=>{const g=()=>xe(f,"name")??"",d=()=>g().includes(Yt)&&g().includes(Xt);return(()=>{var w=Gs(),b=w.firstChild,A=b.firstChild,y=b.nextSibling,$=y.firstChild,k=y.nextSibling,j=k.nextSibling,R=j.nextSibling,L=R.nextSibling,B=L.nextSibling,q=B.nextSibling;return w.addEventListener("wheel",I=>{const x=I.deltaY<0?.05:-.05;c(g(),T=>T+x)}),U(b,(()=>{var I=Ws();return I.$$click=()=>{r(g(),-1)},I})(),A),A.$$click=()=>{r(g(),1)},$.addEventListener("change",I=>{const x=I.currentTarget.value;c(g(),()=>x,"name")}),k.$$mousedown=I=>{I.which===2&&(c(g(),()=>1),i())},k.$$dblclick=()=>{document.querySelector(".comfy-queue-btn").click()},U(k,()=>(xe(f,"weight")??1).toFixed(2)),j.$$click=()=>{c(g(),I=>I-.05)},R.addEventListener("change",I=>{c(g(),()=>parseFloat(I.currentTarget.value))}),R.$$input=I=>{const x=t[h()].weight;!x||x<0||x>2||c(g(),()=>parseFloat(I.currentTarget.value))},L.$$click=()=>{c(g(),I=>I+.05)},B.$$click=()=>{n(t.filter(I=>xe(I,"name")!==xe(f,"name"))),i()},q.addEventListener("change",()=>{d()?c(g(),()=>{var I;return(I=xe(f,"name"))==null?void 0:I.replace(Yt,"").replace(Xt,"")},"name"):c(g(),()=>Yt+(xe(f,"name")??"")+Xt,"name"),i()}),X(I=>{var x=!!d(),T=xe(f,"name"),D=Math.min(o(),0),M=Math.max(s(),2);return x!==I.e&&w.classList.toggle("tmp",I.e=x),T!==I.t&&ge($,"title",I.t=T),D!==I.a&&ge(R,"min",I.a=D),M!==I.o&&ge(R,"max",I.o=M),I},{e:void 0,t:void 0,a:void 0,o:void 0}),X(()=>$.value=xe(f,"name")),X(()=>R.value=xe(f,"weight")),X(()=>q.checked=!d()),w})()};return(()=>{var f=Ys(),h=f.firstChild,g=h.firstChild,d=g.nextSibling,w=d.nextSibling,b=w.nextSibling,A=h.nextSibling;return h.addEventListener("wheel",u),g.$$click=()=>{l(y=>y-.05)},d.$$click=()=>{l(y=>Js(y,1,.05))},w.$$click=a,b.$$click=()=>{l(y=>y+.05)},U(A,he(Ji,{each:t,children:p})),f})()};tt(["click","dblclick","mousedown","input"]);var Zs=G("<div class=settingsPopup><div class=close>❌</div><div class=header>Settings</div><div class=modalContent><div class=mapeSettings>"),Qs=G("<input type=text>"),er=G("<input type=color>"),tr=G("<input type=number>"),nr=G("<input type=checkbox>"),ir=G('<div class=mapeSetting><label class=name></label><div class=reset title="Reset to default value">♻️</div><label class=value>');const po={nodeAlignOffsetY:{name:"Offset Y pixel amount",value:{type:"number",value:50}},nodeOrganizeSpacingInputY:{name:"Node organize input Y spacing",value:{type:"number",value:15}},nodeOrganizeSpacingOutputY:{name:"Node organize output Y spacing",value:{type:"number",value:34}},nodeOrganizeSpacingInputX:{name:"Node organize input X spacing",value:{type:"number",value:200}},nodeOrganizeSpacingOutputX:{name:"Node organize output X spacing",value:{type:"number",value:60}},alwaysPromptVariableName:{name:"Prompt for variable name",value:{type:"bool",value:!1}},collapseNodesOnOrganize:{name:"Collapse GET/SET when organizing node",value:{type:"bool",value:!0}},resizeNodeWidthOnAlignment:{name:"Resize node on left alignment",value:{type:"bool",value:!0}},showAllConnectionsOnFocus:{name:"Show connections for all nodes when focusing variable",value:{type:"bool",value:!0}},organizeSideNodes:{name:"Organize variables when dragging/selecting parent node",value:{type:"bool",value:!0}},replaceSearch:{name:"Hijack Comfy node search to allow fuzzy search (Might break)",value:{type:"bool",value:!0}},showConnectionOnNodeHover:{name:"Show connections when hovering a node",value:{type:"bool",value:!1}},showAllConnectionsOnNodeHover:{name:"Show all connections when hovering a node",value:{type:"bool",value:!1}},animateSelectedNode:{name:"Animate connections of the selected node",value:{type:"bool",value:!1}},animateAllNodes:{name:"Animate connections of all nodes",value:{type:"bool",value:!1}},selectedNodeConnectionOpacity:{name:"Opacity % of selected node connections",value:{type:"number",value:100}},nodeConnectionOpacity:{name:"Opacity % of node connections",value:{type:"number",value:10}},dblClickToRename:{name:"Double click regular node to set title",value:{type:"bool",value:!0}},setIcon:{name:"Set title icon",value:{type:"string",value:"💾 "}},setBackgroundColor:{name:"Set title background color",value:{type:"color",value:"#212121"}},getIcon:{name:"Get title icon",value:{type:"string",value:""}},getBackgroundColor:{name:"Get title background",value:{type:"color",value:"#212121"}},dblClickToRenameGroup:{name:"Double click groups to set title",value:{type:"bool",value:!0}},profileNodes:{name:"Show node runtime duration",value:{type:"bool",value:!0}}},[Jt,ot]=sn(JSON.parse(JSON.stringify(po))),bi=localStorage.mape_helpers_settings;if(bi)try{const e=JSON.parse(bi);for(const[t,n]of Object.entries(e))ot(t,"value","value",n)}catch{console.error("Failed to parse settings")}const te=e=>Jt[e].value.value,or=e=>{const t=()=>{localStorage.mape_helpers_settings=JSON.stringify(Object.fromEntries(Object.entries(Jt).map(([n,i])=>[n,i.value.value])))};return Ae(()=>{JSON.stringify(Jt),t()}),(()=>{var n=Zs(),i=n.firstChild,o=i.nextSibling,s=o.nextSibling,r=s.firstChild;return ri(i,"click",e.close,!0),U(r,()=>Object.entries(Jt).map(([l,{name:c,value:u}])=>(()=>{var a=ir(),p=a.firstChild,f=p.nextSibling,h=f.nextSibling;return ge(p,"for",l),U(p,c),f.$$click=()=>{ot(l,"value","value",po[l].value.value)},U(h,he(qi,{get children(){return[he(Xe,{get when(){return u.type==="string"},get children(){var g=Qs();return g.$$input=d=>{ot(l,"value","value",d.currentTarget.value)},ge(g,"id",l),X(()=>g.value=u.value),g}}),he(Xe,{get when(){return u.type==="color"},get children(){var g=er();return g.$$input=d=>{ot(l,"value","value",d.currentTarget.value)},ge(g,"id",l),X(()=>g.value=u.value),g}}),he(Xe,{get when(){return u.type==="number"},get children(){var g=tr();return g.$$input=d=>{ot(l,"value","value",parseFloat(d.currentTarget.value))},ge(g,"id",l),X(()=>g.value=u.value),g}}),he(Xe,{get when(){return u.type==="bool"},get children(){var g=nr();return g.addEventListener("change",d=>{ot(l,"value","value",d.currentTarget.checked)}),ge(g,"id",l),X(()=>g.checked=u.value),g}})]}})),a})())),n})()};tt(["click","input"]);const ln=e=>e.toLowerCase().replace(/_./g,t=>t.replace("_","").toUpperCase()),$e=e=>graph.links[e]??{},Y=(e,t=0)=>{var n;if(e){if(e.widgets&&e.widgets[t])return e.widgets[t].value;if(e.widgets_values)return(n=e.widgets_values)==null?void 0:n[t]}},At=e=>{graph.add(e)},we=(e,t,n=0)=>{e.widgets_values||(e.widgets_values=[]),e.widgets_values[n]=t,e.widgets[n].value=t},Et=e=>{graph.remove(e)},ho=e=>{var o,s;if(e.type!=="Reroute")return e;const t=(s=(o=e.inputs)==null?void 0:o[0])==null?void 0:s.link;if(!t)return e;const n=$e(t);if(!n)return e;const i=oe(n.origin_id);return i?(setTimeout(()=>{Et(e)}),ho(i)):e},go=e=>{var s,r;if(e.type!=="Reroute")return e;const t=(s=e.outputs[0])==null?void 0:s.links;if(!t)return e;const n=t[0];if(!n)return e;const i=$e(n);if(!i)return e;const o=oe(i.target_id);return o?(((r=e.outputs[0].links)==null?void 0:r.length)===1&&Et(e),go(o)):e},mo=(e,t=!1)=>{var d,w,b,A,y,$,k,j,R,L;const{type:n}=e;if(n==="*")return;let{origin_id:i,target_id:o,origin_slot:s,target_slot:r}=e,l=oe(i),c=oe(o);if(!l||!c||(l.type==="Reroute"&&(l=ho(l),i=l==null?void 0:l.id,s=l==null?void 0:l.outputs.findIndex(B=>B.type===n),(typeof s>"u"||s===-1)&&(s=0)),c.type==="Reroute"&&(c=go(c),o=c==null?void 0:c.id,r=c==null?void 0:c.inputs.findIndex(B=>B.type===n),(typeof r>"u"||r===-1)&&(r=0)),typeof i>"u"||typeof o>"u"||!l||!c)||t&&(ie(l)||ie(c)))return!1;let u=ln(((d=c.getInputInfo(r))==null?void 0:d.name)??n.toLowerCase());u||(u=ln(((b=(w=l==null?void 0:l.outputs)==null?void 0:w[s])==null?void 0:b.name)??((y=(A=l==null?void 0:l.outputs)==null?void 0:A[s])==null?void 0:y.type.toString())??`newVariable_from_${i}_to_${o}`));let a=!1,p=!1;if(ie(l))u=Y(l),p=!0;else{const B=(k=($=l.outputs)==null?void 0:$[s])==null?void 0:k.links;if(B)for(const q of B){const I=oe(((j=$e(q))==null?void 0:j.target_id)??-1);I&&ie(I)&&be(I)&&(u=Y(I),p=!0)}if(!p){for(const q of gn()){const I=Y(q);if(!(u===I&&be(q)))continue;const T=(R=q.inputs[0])==null?void 0:R.link;((L=$e(T))==null?void 0:L.origin_id)===l.id?p=!0:a=!0}a&&(u+=`_from_${i}_to_${o}`)}}let f;if(!p){f=LiteGraph.createNode("mape Variable");const B=l.getConnectionPos(!1,s);f.pos=[B[0]+20,B[1]],f.inputs[0].name=n,f.inputs[0].type=n,f.inputs[0].widget=c.inputs[r].widget,we(f,u),At(f),l.connect(s,f,0),f.flags.collapsed=!0,f==null||f.setSize(f.computeSize())}const h=LiteGraph.createNode("mape Variable"),g=c.getConnectionPos(!0,r);h.pos=[g[0]-150,g[1]],h.outputs[0].name=n,h.outputs[0].type=n,h.outputs[0].widget=c.inputs[r].widget,At(h),we(h,u),h.flags.collapsed=!0,h==null||h.setSize(h.computeSize()),h.connect(0,c,r),!(t||!a||te("alwaysPromptVariableName"))&&setTimeout(()=>{window.setPrompt("Variable name",graph.list_of_graphcanvas[0].last_mouse_position,B=>{we(h,B),f&&we(f,B)},u)},100)},vo=()=>{window.dispatchEvent(new CustomEvent("mapeTweak",{detail:{message:"valueUpdated"}}))},De=(()=>{let e;return()=>{clearTimeout(e),e=setTimeout(vo,50)}})();function sr(e,t){t&&(e.save(),e.fillStyle="#000",e.fillText(t,6,-LiteGraph.NODE_TITLE_HEIGHT-2+1),e.fillStyle="#fff",e.fillText(t,5,-LiteGraph.NODE_TITLE_HEIGHT-2),e.restore())}const $i=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),wi="eexxaacctt",ki=(e,t)=>t==0?"":t==1?`${e}??`:t==1/0?`${e}*?`:`${e}{0,${t}}?`;function rr(){const e={interSplit:"[^A-Za-z\\d']+",intraSplit:"[a-z][A-Z]",intraBound:"[A-Za-z]\\d|\\d[A-Za-z]|[a-z][A-Z]",interChars:".",interIns:1/0,intraChars:"[a-z\\d']",intraIns:0,intraContr:"'[a-z]{1,2}\\b"},{intraIns:t,intraContr:n,intraSplit:i,interSplit:o,intraBound:s,intraChars:r}=e,l='".+?"',c=new RegExp(l,"gi"),u=new RegExp(`(?:\\s+|^)-(?:${r}+|${l})`,"gi"),a=!!i,p=new RegExp(i,"g"),f=new RegExp(o,"g"),h=new RegExp(`^${o}|${o}$`,"g"),g=new RegExp(n,"gi"),d=y=>{const $=[];y=y.replace(c,j=>($.push(j),wi)),y=y.replace(h,"").toLocaleLowerCase(),a&&(y=y.replace(p,j=>`${j[0]} ${j[1]}`));let k=0;return y.split(f).filter(j=>j!="").map(j=>j===wi?$[k++]:j)},w=y=>{let $=d(y);if($.length==0)return[void 0];const k=Array($.length).fill("");$=$.map((B,q)=>B.replace(g,I=>(k[q]=I,"")));const j=ki(r,t);let R=$.map((B,q)=>B[0]==='"'?$i(B.slice(1,-1)):B.split("").join(j)+k[q]);const L=ki(e.interChars,e.interIns);return R=R.join(L),[new RegExp(R,"i")]},b=(y,$,k)=>{const[j]=w($);if(!j)return[];const R=[];if(k!=null)for(let L=0;L<k.length;L++){const B=k[L];j.test(y[B])&&R.push(B)}else for(let L=0;L<y.length;L++)j.test(y[L])&&R.push(L.toString());return R};return(y,$)=>{let k,R=null,L=[];$=$.replace(u,q=>{let I=q.trim().slice(1);return I[0]==='"'&&(I=$i(I.slice(1,-1))),""});const B=d($);if(B.length==0)return[];if(B.length>1){const q=B.slice().sort((x,T)=>T.length-x.length);for(let x=0;x<q.length;x++){if((k==null?void 0:k.length)==0)return[];k=b(y,q[x],k)}if(B.length>2)return k;R=lr(B).map(x=>x.join(" ")),L.length=0;const I=new Set;for(let x=0;x<R.length;x++)if(I.size<(k==null?void 0:k.length)){const T=k==null?void 0:k.filter(M=>!I.has(M)),D=b(y,R[x],T);for(let M=0;M<D.length;M++)I.add(D[M]);L.push(D)}else L.push([])}return R==null&&(R=[$],L=[(k==null?void 0:k.length)>0?k:b(y,$)]),L.flat()}}function lr(e){e=e.slice();const t=e.length,n=[e.slice()],i=new Array(t).fill(0);let o=1,s,r;for(;o<t;)i[o]<o?(s=o%2&&i[o],r=e[o],e[o]=e[s],e[s]=r,++i[o],o=1,n.push(e.slice())):(i[o]=0,++o);return n}const ar=rr();function cr(e,t){return ar([t],e).length>0}const ur=e=>{const t=Y(e);return Qi().find(n=>Y(n)===t)};function dr(e){return .5-.5*Math.cos(Math.PI*e)}function xi(e,t,n){return n=dr(n),e+n*(t-e)}const yo=([e,t],n)=>{const i=n.ds,o=document.body.clientWidth,s=document.body.clientHeight,r=i.scale,l=-e+o*.5/r,c=-t+s*.5/r,u=250,a=Date.now()+u,p=i.offset[0],f=i.offset[1],h=()=>{const g=a-Date.now();if(Date.now()<a)requestAnimationFrame(h);else{i.offset[0]=l,i.offset[1]=c,n.setDirty(!0,!0);return}const d=1-g/u;i.offset[0]=xi(p,l,d),i.offset[1]=xi(f,c,d),n.setDirty(!0,!0)};requestAnimationFrame(h)},dt=e=>{var r;const t=(r=e.graph)==null?void 0:r.list_of_graphcanvas[0],[n,i]=e.pos,[o,s]=e.size;yo([n+o/2,i+s/2],t),t==null||t.selectNode(e)},fr=e=>e?e.mode===0?!0:e.mode!==2:!1,an=(e,t=!1)=>{var r,l,c;if(e.length===0)return;const n=te("nodeOrganizeSpacingInputX"),i=te("nodeOrganizeSpacingOutputX");if(e.filter(u=>!ie(u)).length===0)return;for(const u of e){let a=0,p=0;const f=te("nodeOrganizeSpacingInputY"),h=te("nodeOrganizeSpacingOutputY"),g=[];if(u.graph){for(const d of u.inputs??[]){const w=d.link;if(!w)continue;const{origin_id:b,target_slot:A}=$e(w),y=oe(b);if(!y||y.type!==Me)continue;if(y.outputs&&y.outputs[0]&&y.outputs[0].links&&y.outputs[0].links.length>1)return;const $=u.getConnectionPos(!0,A);y.pos=[$[0]-n,$[1]+15+a*f],a+=1,g.push(y),y.flags.collapsed=te("collapseNodesOnOrganize")}for(const d of u.outputs??[])if(d.links&&u.graph)for(const w of d.links){const{target_id:b}=$e(w),A=oe(b);if(!A){console.error("Failed",u.id,">",b);continue}if(A.type!==Me)continue;const y=(l=(r=A.outputs)==null?void 0:r[0])==null?void 0:l.links;if(y&&y.length>1)return;const $=u.getConnectionPos(!1,0);A.pos=[$[0]+i,$[1]+15+p*h],p+=1,g.push(A),A.flags.collapsed=te("collapseNodesOnOrganize")}if(t&&e.length===1){const d=[u,...g];u.graph.list_of_graphcanvas[0].selectNodes(d)}}}const o=e[0];if(!o)return;((c=o.graph)==null?void 0:c.list_of_graphcanvas[0]).setDirty(!0,!0),De()},_n=()=>graph.links??[],An=(e,t)=>{var s,r,l;const n=(s=app.canvas)==null?void 0:s.default_connection_color_byType,i=(r=e.inputs)==null?void 0:r[0],o=(l=e.outputs)==null?void 0:l[0];i&&(i.name=t,i.type=t,i.color_on=n[t]),o&&(o.name=t,o.type=t,o.color_on=n[t])},Si=e=>{const t=(n,i=!1,o=s=>{})=>{if(!e.graph)return;const s=Object.values(_n()).filter(Boolean).find(l=>l.id===n);if(!s)return;if(i){const l=oe(s.origin_id);if(!l)return;const c=l.outputs[s.origin_slot].type.toString();An(e,c),o(c);return}if(!s){An(e,ms);return}const r=s.type;An(e,r),o(r)};setTimeout(()=>{var n,i,o,s,r,l;if(be(e)){const c=(i=(n=e.inputs)==null?void 0:n[0])==null?void 0:i.link;if(!c)return;t(c,!0,u=>{const a=Y(e);localStorage[`mape_tweak_${a}`]&&(localStorage[`mape_tweak_${a}`]=u)})}else if(ct(e)){const c=(r=(s=(o=e.outputs)==null?void 0:o[0])==null?void 0:s.links)==null?void 0:r[0];c&&t(c)}if(be(e)){const c=Y(e);(l=e.widgets)!=null&&l[1]||e.addWidget("toggle","tweak",!!localStorage[`mape_tweak_${c}`],u=>{var f,h;const a=(h=(f=e.inputs)==null?void 0:f[0])==null?void 0:h.type,p=Y(e);u?localStorage[`mape_tweak_${p}`]=a:delete localStorage[`mape_tweak_${p}`],De()}),e.setProperty("tweak",!!localStorage[`mape_tweak_${c}`])}})},En="",pr=async()=>{const{app:e}=await lt(()=>import(`${En}/scripts/app.js`),__vite__mapDeps([]));let t;e.registerExtension({name:"cg.customnodes.mape_helpers_boostrap",async init(){const d=e.graph.onConfigure;e.graph.onConfigure=function(...w){[t]=w,d.apply(this,w)}}});const{api:n}=await lt(()=>import(`${En}/scripts/api.js`),__vite__mapDeps([])),{setWidgetConfig:i}=await lt(()=>import(`${En}/extensions/core/widgetInputs.js`),__vite__mapDeps([]));let o,s={};async function r(){s={};const w=Pe().filter(b=>fr(b)).filter(b=>ie(b));for(const b of w.filter(be)){s[b.id]=[];const A=Y(b);for(const y of w){const $=Y(y);A===$&&b.id!==y.id&&s[b.id].push(y.id)}}}async function l(){const d=St(await o.apply(e)),w={},b={};for(const y of d.workflow.nodes.filter(ie).filter(be)){const $=Y(y),k=y.inputs[0];if(k.link){const j=$e(k.link);b[$]={originId:j.origin_id,originIndex:j.origin_slot}}}for(const y of d.workflow.nodes.filter(ie)){const $=Y(y);if(y.inputs[0].link){const j=d.workflow.links.find(I=>{const[x,T,D,M,P,F]=I;return M===y.id});if(!j)continue;let R=j[1],L=j[2];const B=oe(R);if(!B)continue;if(B.mode===4){const x=B.outputs[L].type,T=D=>{const M=F=>{if(F)for(const v of St(F).sort((m,_)=>m.type===x?-1:_.type===x?1:0)){const m=v.link;if(!m)continue;const _=$e(m),{origin_id:E}=_;if(!E)continue;const C=oe(E);if(C){if(C.mode===4){T(C);continue}if(ie(C)){const H=Y(C),N=b[H];if(!N)continue;const z=oe(N.originId);if(!z)continue;T(z);continue}}}};if(!D)return;if(D.mode===4||ie(D))M(D.inputs);else{let F=!1,v=0;for(const m of D.outputs){if(m.type===x){R=D.id,L=v,F=!0;break}v+=1}if(!F){if(!Array.isArray(D.inputs))return;M(D.inputs)}}};T(B)}b[$]={originId:R,originIndex:L};continue}w[y.id]=$}d.output=Object.fromEntries(Object.entries(d.output).filter(([y,$])=>$.class_type!==Me).map(([y,$])=>($.inputs=Object.fromEntries(Object.entries($.inputs).map(([k,j])=>{if(Array.isArray(j)){const[R,L]=j,B=w[R],q=b[B];if(q){const I=oe(q.originId);if(I&&I.type==="PrimitiveNode")return[k,Y(I)]}return!B||!q?[k,j]:[k,[q.originId.toString(),q.originIndex]]}else return[k,j]})),[y,$])));const A=new RegExp(`${Yt}.*?${Xt}`,"g");return d.output=Object.fromEntries(Object.entries(d.output).map(([y,$])=>($.inputs=Object.fromEntries(Object.entries($.inputs).map(([k,j])=>Array.isArray(j)?[k,j]:typeof j=="string"?[k,j.replaceAll(A,"").replace(/\(:\d+\.?\d+?\)/g,"")]:[k,j])),[y,$])).filter(Boolean)),localStorage.debugOutput&&console.info(JSON.stringify(d,null,"  ")),d}let c=!1,u=!1,a;const p=LGraphCanvas.prototype.showLinkMenu,f=function(d,w){return w.shiftKey?(mo(d),!1):(p.apply(this,[d,w]),!1)},h=d=>{setTimeout(()=>{for(const w of d.nodes){if(w.type!=="PrimitiveNode")continue;const b=oe(w.id);if(b)for(const[A,y]of(w.widgets_values??[]).entries())b.widgets[A].value=y}e.graph.setDirtyCanvas(!0,!0),De()})},g={name:"cg.customnodes.mape_helpers",async beforeRegisterNodeDef(d,w){for(const A of["onAdded","onConnectInput","onConnectionsChange","onConnectOutput","onRemoved","onSelected","onDeselected","onPropertyChanged","onWidgetChanged","onMouseMove"]){const y=d.prototype[A];d.prototype[A]=function(...$){De(),y==null||y.apply(this,$)}}if(w.display_name!==Me){const A=d.prototype.onDblClick;d.prototype.onDblClick=function(...$){A==null||A.apply(this,$);const k=$[1],[,j]=k;if(!te("dblClickToRename")||j>0)return;const R=prompt("Name",this.title);R&&(this.title=R)};const y=d.prototype.onDrawForeground;d.prototype.onDrawForeground=function(...$){if(te("profileNodes")){const[k]=$;sr(k,this.executionDuration||"")}return y==null?void 0:y.apply(this,$)};return}const b=d.prototype.onConnectionsChange;d.prototype.onConnectionsChange=function(...A){const[y]=A,$=this;if((y===2?"output":"input")==="output"){if(be($)){$.disconnectOutput(0);return}}else if(ct($)){$.disconnectInput(0);return}ie($)&&y==1&&Si($),b==null||b.apply($,A)},d.prototype.getTitle=function(){const A=this,y=be(A),$=te(y?"setIcon":"getIcon");d.title_color=te(y?"setBackgroundColor":"getBackgroundColor");const k=Y(A);return k?`${$}${k}`:A.title},d.prototype.onSelected=function(){c=!0},d.prototype.onMouseEnter=function(){a=this,u=!0},d.prototype.onMouseLeave=function(){a=void 0,u=!1},d.prototype.onDeselected=()=>{c=!1},d.prototype.onRemoved=()=>{c=!1},d.prototype.onDblClick=function(){const A=this;A.flags.collapsed=!A.flags.collapsed}},async nodeCreated(d){const w=d;if(w.IS_MAPE_VARIABLE=ie(d),!w.IS_MAPE_VARIABLE)return;d.onGraphConfigured=()=>{};const b=d.configure;d.configure=function(...A){b.apply(this,A);const y={FLOAT:{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,step:.1,round:.01},INT:{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER},STRING:{default:""}};d.inputs=St(A[0].inputs).map($=>(i($,[$.type,y[$.type]]),$)),Si(d)}},async setup(){var I;o=e.graphToPrompt,h(t),te("replaceSearch")&&(String.prototype.__indexOf=String.prototype.indexOf,String.prototype.indexOf=function(x,T){var M;const D=this;return(M=new Error().stack)!=null&&M.match(/refreshHelper/)?cr(x,D)?1:-1:this.__indexOf(x,T)}),document.addEventListener("keydown",x=>{x.key==="z"&&x.ctrlKey&&x.preventDefault()});let d=!0;e.graphToPrompt=async function(){return d?(await o(),l()):o.apply(e)};for(const x of["status","reconnecting","reconnected","executing","executed","execution_start","execution_error","b_preview","progress"])n.addEventListener(x,De);const w=new Map;let b=0;for(const x of["executing"])n.addEventListener(x,T=>{var F;const D=((F=T==null?void 0:T.detail)==null?void 0:F.node)??(T==null?void 0:T.detail),M=oe(D);M&&(M.executionDuration="");const P=w.get(b);if(w.delete(b),b&&P){const v=Date.now()-P,m=oe(b);m&&(m.executionDuration=`${(v/1e3).toFixed(2)}s`)}b=D,w.set(D,Date.now())});let A;n.addEventListener("progress",x=>{clearTimeout(A);const{value:T,max:D,node:M}=x.detail,P=oe(M);T&&D&&M&&(document.title=`${P&&P.title?`${P.title}: `:""}${T}/${D} (${(T/D*100).toFixed(0)}%)`,T===D&&(document.title="Completed!",A=setTimeout(()=>{document.title="ComfyUI"},2e3))),De()});const y=e.ui.dialog.show;window.mapeErrors=[],e.ui.dialog.show=function(...x){setTimeout(()=>{if(e.lastNodeErrors){for(const[T,D]of Object.entries(e.lastNodeErrors)){const M=oe(parseFloat(T));for(const P of D.errors)window.mapeErrors.push({text:P.message,type:P.details,node:M})}De(),window.showWarnings(!0)}}),y.apply(this,x)};const $=document.getElementById("comfy-save-button");if($){const x=$.onclick;$.onclick=function(T){d=!1,x(T),d=!0}}const k=document.getElementById("comfy-dev-save-api-button");if(k){const x=k.onclick;k.onclick=function(T){d=!1,x(T),d=!0}}const j=LGraphCanvas.prototype.drawFrontCanvas;LGraphCanvas.prototype.drawFrontCanvas=function(...x){if(j.apply(this,x),!c&&!u)return;let T=vs();if(!T&&a&&te("showAllConnectionsOnNodeHover")&&(T=a),!T&&a&&te("showConnectionOnNodeHover")&&(ct(a)?T=ur(a):T=a),!T||!e.canvas)return;const D=!c&&u&&!te("showAllConnectionsOnNodeHover")&&te("showConnectionOnNodeHover");r();const M=this.ctx;for(const P of Pe().filter(F=>ie(F))){const F=P;if(D&&P.id!==T.id)continue;P.id,F.id,ct(P);const v=s[F.id];if(!v)continue;const m=window.innerWidth,_=window.innerHeight;for(const E of v){const C=oe(E);if(!C){console.error("failed",F.id,E);continue}const H=Y(T),N=Y(C);if(!te("showAllConnectionsOnFocus")&&H!==N)continue;const z=F.getConnectionPos(!0,0),S=C.getConnectionPos(!0,0),J=e.canvas.ds.scale,K=e.canvas.ds.offset;z[0]=z[0]*J+K[0]*J,z[1]=z[1]*J+K[1]*J,S[0]=S[0]*J+K[0]*J,S[1]=S[1]*J+K[1]*J;const V=S[0]-z[0],O=S[1]-z[1],W=LiteGraph.LEFT,Z=Math.abs(O)>Math.abs(V)?O>0?LiteGraph.DOWN:LiteGraph.UP:V<0?LiteGraph.LEFT:LiteGraph.RIGHT,Q=z[0]>0&&z[1]>0&&z[0]<m&&z[1]<_,me=S[0]>0&&S[1]>0&&S[0]<m&&S[1]<_;if(!Q&&!me)continue;M.save(),M.shadowColor="#000",M.shadowBlur=15,M.lineCap="round";const Oe=H===N,vt=te("animateAllNodes")||Oe&&te("animateSelectedNode")||!1;e.canvas.renderLink(M,z,S,void 0,!0,vt,Oe?`rgba(255,244,53,${te("selectedNodeConnectionOpacity")/100})`:`rgba(255,255,255,${te("nodeConnectionOpacity")/100})`,Z,W),M.restore()}}},LGraphCanvas.prototype.showLinkMenu=f;const R=LGraphCanvas.prototype.showConnectionMenu;LGraphCanvas.prototype.showConnectionMenu=function(...x){L||(this.use_original_menu=!0,R.apply(this,x),this.use_original_menu=!1)};let L=!1,B=!1;document.addEventListener("keydown",x=>{B=x.ctrlKey,L=x.shiftKey}),e.canvas._mousemove_callback=()=>{if(!te("organizeSideNodes"))return;const x=Ye();an(x)},document.addEventListener("keyup",x=>{var M;const T=document.activeElement;if(T.tagName==="INPUT"&&(T.type==="text"||T.type==="number")||T.tagName==="TEXTAREA")return;if(x.key==="A"&&x.shiftKey){document.querySelector(".comfy-queue-btn").click();return}if(x.key==="ArrowLeft"&&x.shiftKey){const P=Ye(),F=Math.min(...P.map(m=>m.pos[0])),v=Math.max(...P.map(m=>m.size[0]));for(const m of P)m.pos=[F,m.pos[1]],te("resizeNodeWidthOnAlignment")&&(m.size=[v,m.size[1]]);return}if(x.key==="ArrowDown"&&x.shiftKey){const P=Ye().filter(_=>!ie(_)),F=Math.min(...P.map(_=>_.pos[1])),v=te("nodeAlignOffsetY");let m=0;for(const _ of P.sort((E,C)=>E.pos[1]-C.pos[1])){_.pos=[_.pos[0],F+m];const E=_.size[1]+v;m+=E}return}if(x.key==="ArrowUp"&&x.shiftKey){const P=Ye(),F=Math.min(...P.map(v=>v.pos[1]));for(const v of P)v.pos=[v.pos[0],F];return}if(x.key==="O"&&x.shiftKey){const P=Ye();an(P,!0)}const D=Ye()[0];if(!(!D||!D.type||D.type!==Me)){if(x.key==="w"){const P=Y(D);setTimeout(()=>{var F,v,m;window.setPrompt("Variable name",((m=(v=(F=D.graph)==null?void 0:F.list_of_graphcanvas)==null?void 0:v[0])==null?void 0:m.last_mouse_position)??[document.body.clientWidth/2,document.body.clientHeight/2],_=>{if(_){localStorage[`mape_tweak_${P}`]&&(localStorage[`mape_tweak_${_}`]=localStorage[`mape_tweak_${P}`],delete localStorage[`mape_tweak_${P}`]);for(const E of graph._nodes)Y(E)===P&&we(E,_);De()}},P)})}if(x.key==="s"){const P=Y(D);for(const F of graph._nodes)Y(F)===P&&(M=F.inputs)!=null&&M[0].link&&dt(F)}if(x.key==="ArrowLeft"||x.key==="ArrowRight"){const P=x.key==="ArrowLeft"?-1:1,F=D,v=Y(F);let m=graph._nodes.filter(N=>Y(N)===v);const _=m.find(be);if(!_)return;m=m.sort((N,z)=>{const S=Vn(_.pos[0],_.pos[1],N.pos[0],N.pos[1]),J=Vn(_.pos[0],_.pos[1],z.pos[0],z.pos[1]);return S-J});const C=m.findIndex(N=>N.id===F.id)+P,H=m.length;if(C>H-1||C<0)return;dt(m[C])}if(x.key.match(/^\d+$/)){const P=parseFloat(x.key)-1,v=Y(D),_=graph._nodes.filter(E=>Y(E)===v)[P];_&&dt(_)}}}),document.body.addEventListener("keyup",()=>{B=!1,L=!1});let q=(I=e.canvas)==null?void 0:I.allow_searchbox;Object.defineProperty(e.canvas,"allow_searchbox",{get:function(){var D;const x=this.graph.getGroupOnPos(...this.canvas_mouse),T=this.connecting_node&&ie(this.connecting_node);if(!L||T)return q;if(this.connecting_input){const M=ln((D=this.connecting_input.name)==null?void 0:D.toLowerCase()),P=LiteGraph.createNode("mape Variable");P.pos=[this.canvas_mouse[0]+10,this.canvas_mouse[1]],At(P);const F=this.connecting_input.slot_index;return we(P,M),P.connect(0,this.connecting_node,F),P.flags.collapsed=!0,P.setSize(P.computeSize()),setTimeout(()=>{var v,m;window.setPrompt("Variable name",((m=(v=graph.list_of_graphcanvas)==null?void 0:v[0])==null?void 0:m.last_mouse_position)??[document.body.clientWidth/2,document.body.clientHeight/2],_=>{we(P,_)},M)}),!1}else if(this.connecting_output){const M=ln(this.connecting_output.name??this.connecting_output.type),P=LiteGraph.createNode("mape Variable");P.pos=[this.canvas_mouse[0]+10,this.canvas_mouse[1]],At(P);const F=this.connecting_output.slot_index;if(we(P,M),this.connecting_node.connect(F,P,0),P.flags.collapsed=!0,P.setSize(P.computeSize()),!B)return setTimeout(()=>{var m,_;window.setPrompt("Variable name",((_=(m=graph.list_of_graphcanvas)==null?void 0:m[0])==null?void 0:_.last_mouse_position)??[document.body.clientWidth/2,document.body.clientHeight/2],E=>{we(P,E)},M)}),!1;const v=LiteGraph.createNode("mape Variable");return v.pos=[this.canvas_mouse[0]+10,this.canvas_mouse[1]+50],At(v),we(v,M),v.flags.collapsed=!0,v.setSize(v.computeSize()),setTimeout(()=>{var m,_;window.setPrompt("Variable name",((_=(m=graph.list_of_graphcanvas)==null?void 0:m[0])==null?void 0:_.last_mouse_position)??[document.body.clientWidth/2,document.body.clientHeight/2],E=>{we(P,E),we(v,E)},M)}),!1}return x&&L&&te("dblClickToRenameGroup")?(L=!1,setTimeout(()=>{const M=prompt("Change group name",x.title);M&&(x.title=M,e.graph.setDirtyCanvas(!0,!0))},100),!1):!0},set:function(x){q=x}})}};e.registerExtension(g)},hr=Object.freeze(Object.defineProperty({__proto__:null,registerPlugin:pr},Symbol.toStringTag,{value:"Module"})),Cn=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Pn(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on".concat(t),n)}function yt(e,t,n,i){e.removeEventListener?e.removeEventListener(t,n,i):e.deachEvent&&e.deachEvent("on".concat(t),n)}function _o(e,t){const n=t.slice(0,t.length-1);for(let i=0;i<n.length;i++)n[i]=e[n[i].toLowerCase()];return n}function bo(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const t=e.split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}function gr(e,t){const n=e.length>=t.length?e:t,i=e.length>=t.length?t:e;let o=!0;for(let s=0;s<n.length;s++)i.indexOf(n[s])===-1&&(o=!1);return o}const It={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":Cn?173:189,"=":Cn?61:187,";":Cn?59:186,"'":222,"[":219,"]":221,"\\":220},je={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},Zn={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},ve={16:!1,18:!1,17:!1,91:!1},ce={};for(let e=1;e<20;e++)It["f".concat(e)]=111+e;let ne=[],Ct=null,$o="all";const Ie=new Map,Rt=e=>It[e.toLowerCase()]||je[e.toLowerCase()]||e.toUpperCase().charCodeAt(0),mr=e=>Object.keys(It).find(t=>It[t]===e),vr=e=>Object.keys(je).find(t=>je[t]===e);function wo(e){$o=e||"all"}function Tt(){return $o||"all"}function yr(){return ne.slice(0)}function _r(){return ne.map(e=>mr(e)||vr(e)||String.fromCharCode(e))}function br(){const e=[];return Object.keys(ce).forEach(t=>{ce[t].forEach(n=>{let{key:i,scope:o,mods:s,shortcut:r}=n;e.push({scope:o,shortcut:r,mods:s,keys:i.split("+").map(l=>Rt(l))})})}),e}function $r(e){const t=e.target||e.srcElement,{tagName:n}=t;let i=!0;return(t.isContentEditable||(n==="INPUT"||n==="TEXTAREA"||n==="SELECT")&&!t.readOnly)&&(i=!1),i}function wr(e){return typeof e=="string"&&(e=Rt(e)),ne.indexOf(e)!==-1}function kr(e,t){let n,i;e||(e=Tt());for(const o in ce)if(Object.prototype.hasOwnProperty.call(ce,o))for(n=ce[o],i=0;i<n.length;)n[i].scope===e?n.splice(i,1).forEach(r=>{let{element:l}=r;return li(l)}):i++;Tt()===e&&wo(t||"all")}function xr(e){let t=e.keyCode||e.which||e.charCode;const n=ne.indexOf(t);if(n>=0&&ne.splice(n,1),e.key&&e.key.toLowerCase()==="meta"&&ne.splice(0,ne.length),(t===93||t===224)&&(t=91),t in ve){ve[t]=!1;for(const i in je)je[i]===t&&(re[i]=!1)}}function ko(e){if(typeof e>"u")Object.keys(ce).forEach(o=>{Array.isArray(ce[o])&&ce[o].forEach(s=>Kt(s)),delete ce[o]}),li(null);else if(Array.isArray(e))e.forEach(o=>{o.key&&Kt(o)});else if(typeof e=="object")e.key&&Kt(e);else if(typeof e=="string"){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];let[o,s]=n;typeof o=="function"&&(s=o,o=""),Kt({key:e,scope:o,method:s,splitKey:"+"})}}const Kt=e=>{let{key:t,scope:n,method:i,splitKey:o="+"}=e;bo(t).forEach(r=>{const l=r.split(o),c=l.length,u=l[c-1],a=u==="*"?"*":Rt(u);if(!ce[a])return;n||(n=Tt());const p=c>1?_o(je,l):[],f=[];ce[a]=ce[a].filter(h=>{const d=(i?h.method===i:!0)&&h.scope===n&&gr(h.mods,p);return d&&f.push(h.element),!d}),f.forEach(h=>li(h))})};function Ai(e,t,n,i){if(t.element!==i)return;let o;if(t.scope===n||t.scope==="all"){o=t.mods.length>0;for(const s in ve)Object.prototype.hasOwnProperty.call(ve,s)&&(!ve[s]&&t.mods.indexOf(+s)>-1||ve[s]&&t.mods.indexOf(+s)===-1)&&(o=!1);(t.mods.length===0&&!ve[16]&&!ve[18]&&!ve[17]&&!ve[91]||o||t.shortcut==="*")&&(t.keys=[],t.keys=t.keys.concat(ne),t.method(e,t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function Ei(e,t){const n=ce["*"];let i=e.keyCode||e.which||e.charCode;if(!re.filter.call(this,e))return;if((i===93||i===224)&&(i=91),ne.indexOf(i)===-1&&i!==229&&ne.push(i),["ctrlKey","altKey","shiftKey","metaKey"].forEach(l=>{const c=Zn[l];e[l]&&ne.indexOf(c)===-1?ne.push(c):!e[l]&&ne.indexOf(c)>-1?ne.splice(ne.indexOf(c),1):l==="metaKey"&&e[l]&&ne.length===3&&(e.ctrlKey||e.shiftKey||e.altKey||(ne=ne.slice(ne.indexOf(c))))}),i in ve){ve[i]=!0;for(const l in je)je[l]===i&&(re[l]=!0);if(!n)return}for(const l in ve)Object.prototype.hasOwnProperty.call(ve,l)&&(ve[l]=e[Zn[l]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(ne.indexOf(17)===-1&&ne.push(17),ne.indexOf(18)===-1&&ne.push(18),ve[17]=!0,ve[18]=!0);const o=Tt();if(n)for(let l=0;l<n.length;l++)n[l].scope===o&&(e.type==="keydown"&&n[l].keydown||e.type==="keyup"&&n[l].keyup)&&Ai(e,n[l],o,t);if(!(i in ce))return;const s=ce[i],r=s.length;for(let l=0;l<r;l++)if((e.type==="keydown"&&s[l].keydown||e.type==="keyup"&&s[l].keyup)&&s[l].key){const c=s[l],{splitKey:u}=c,a=c.key.split(u),p=[];for(let f=0;f<a.length;f++)p.push(Rt(a[f]));p.sort().join("")===ne.sort().join("")&&Ai(e,c,o,t)}}function re(e,t,n){ne=[];const i=bo(e);let o=[],s="all",r=document,l=0,c=!1,u=!0,a="+",p=!1,f=!1;for(n===void 0&&typeof t=="function"&&(n=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(s=t.scope),t.element&&(r=t.element),t.keyup&&(c=t.keyup),t.keydown!==void 0&&(u=t.keydown),t.capture!==void 0&&(p=t.capture),typeof t.splitKey=="string"&&(a=t.splitKey),t.single===!0&&(f=!0)),typeof t=="string"&&(s=t),f&&ko(e,s);l<i.length;l++)e=i[l].split(a),o=[],e.length>1&&(o=_o(je,e)),e=e[e.length-1],e=e==="*"?"*":Rt(e),e in ce||(ce[e]=[]),ce[e].push({keyup:c,keydown:u,scope:s,mods:o,shortcut:i[l],method:n,key:i[l],splitKey:a,element:r});if(typeof r<"u"&&window){if(!Ie.has(r)){const h=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return Ei(d,r)},g=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;Ei(d,r),xr(d)};Ie.set(r,{keydownListener:h,keyupListenr:g,capture:p}),Pn(r,"keydown",h,p),Pn(r,"keyup",g,p)}if(!Ct){const h=()=>{ne=[]};Ct={listener:h,capture:p},Pn(window,"focus",h,p)}}}function Sr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(ce).forEach(n=>{ce[n].filter(o=>o.scope===t&&o.shortcut===e).forEach(o=>{o&&o.method&&o.method()})})}function li(e){const t=Object.values(ce).flat();if(t.findIndex(i=>{let{element:o}=i;return o===e})<0){const{keydownListener:i,keyupListenr:o,capture:s}=Ie.get(e)||{};i&&o&&(yt(e,"keyup",o,s),yt(e,"keydown",i,s),Ie.delete(e))}if((t.length<=0||Ie.size<=0)&&(Object.keys(Ie).forEach(o=>{const{keydownListener:s,keyupListenr:r,capture:l}=Ie.get(o)||{};s&&r&&(yt(o,"keyup",r,l),yt(o,"keydown",s,l),Ie.delete(o))}),Ie.clear(),Object.keys(ce).forEach(o=>delete ce[o]),Ct)){const{listener:o,capture:s}=Ct;yt(window,"focus",o,s),Ct=null}}const jn={getPressedKeyString:_r,setScope:wo,getScope:Tt,deleteScope:kr,getPressedKeyCodes:yr,getAllKeyCodes:br,isPressed:wr,filter:$r,trigger:Sr,unbind:ko,keyMap:It,modifier:je,modifierMap:Zn};for(const e in jn)Object.prototype.hasOwnProperty.call(jn,e)&&(re[e]=jn[e]);if(typeof window<"u"){const e=window.hotkeys;re.noConflict=t=>(t&&window.hotkeys===re&&(window.hotkeys=e),re),window.hotkeys=re}const qt=window,ai=qt.ShadowRoot&&(qt.ShadyCSS===void 0||qt.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,ci=Symbol(),Ci=new WeakMap;let xo=class{constructor(t,n,i){if(this._$cssResult$=!0,i!==ci)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=n}get styleSheet(){let t=this.o;const n=this.t;if(ai&&t===void 0){const i=n!==void 0&&n.length===1;i&&(t=Ci.get(n)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&Ci.set(n,t))}return t}toString(){return this.cssText}};const Ar=e=>new xo(typeof e=="string"?e:e+"",void 0,ci),bn=(e,...t)=>{const n=e.length===1?e[0]:t.reduce((i,o,s)=>i+(r=>{if(r._$cssResult$===!0)return r.cssText;if(typeof r=="number")return r;throw Error("Value passed to 'css' function must be a 'css' function result: "+r+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+e[s+1],e[0]);return new xo(n,e,ci)},Er=(e,t)=>{ai?e.adoptedStyleSheets=t.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet):t.forEach(n=>{const i=document.createElement("style"),o=qt.litNonce;o!==void 0&&i.setAttribute("nonce",o),i.textContent=n.cssText,e.appendChild(i)})},Pi=ai?e=>e:e=>e instanceof CSSStyleSheet?(t=>{let n="";for(const i of t.cssRules)n+=i.cssText;return Ar(n)})(e):e;var On;const cn=window,ji=cn.trustedTypes,Cr=ji?ji.emptyScript:"",Oi=cn.reactiveElementPolyfillSupport,Qn={toAttribute(e,t){switch(t){case Boolean:e=e?Cr:null;break;case Object:case Array:e=e==null?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=e!==null;break;case Number:n=e===null?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch{n=null}}return n}},So=(e,t)=>t!==e&&(t==t||e==e),In={attribute:!0,type:String,converter:Qn,reflect:!1,hasChanged:So},ei="finalized";let st=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(t){var n;this.finalize(),((n=this.h)!==null&&n!==void 0?n:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach((n,i)=>{const o=this._$Ep(i,n);o!==void 0&&(this._$Ev.set(o,i),t.push(o))}),t}static createProperty(t,n=In){if(n.state&&(n.attribute=!1),this.finalize(),this.elementProperties.set(t,n),!n.noAccessor&&!this.prototype.hasOwnProperty(t)){const i=typeof t=="symbol"?Symbol():"__"+t,o=this.getPropertyDescriptor(t,i,n);o!==void 0&&Object.defineProperty(this.prototype,t,o)}}static getPropertyDescriptor(t,n,i){return{get(){return this[n]},set(o){const s=this[t];this[n]=o,this.requestUpdate(t,s,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||In}static finalize(){if(this.hasOwnProperty(ei))return!1;this[ei]=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),t.h!==void 0&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const n=this.properties,i=[...Object.getOwnPropertyNames(n),...Object.getOwnPropertySymbols(n)];for(const o of i)this.createProperty(o,n[o])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const n=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const o of i)n.unshift(Pi(o))}else t!==void 0&&n.push(Pi(t));return n}static _$Ep(t,n){const i=n.attribute;return i===!1?void 0:typeof i=="string"?i:typeof t=="string"?t.toLowerCase():void 0}_$Eu(){var t;this._$E_=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(t=this.constructor.h)===null||t===void 0||t.forEach(n=>n(this))}addController(t){var n,i;((n=this._$ES)!==null&&n!==void 0?n:this._$ES=[]).push(t),this.renderRoot!==void 0&&this.isConnected&&((i=t.hostConnected)===null||i===void 0||i.call(t))}removeController(t){var n;(n=this._$ES)===null||n===void 0||n.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((t,n)=>{this.hasOwnProperty(n)&&(this._$Ei.set(n,this[n]),delete this[n])})}createRenderRoot(){var t;const n=(t=this.shadowRoot)!==null&&t!==void 0?t:this.attachShadow(this.constructor.shadowRootOptions);return Er(n,this.constructor.elementStyles),n}connectedCallback(){var t;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(t=this._$ES)===null||t===void 0||t.forEach(n=>{var i;return(i=n.hostConnected)===null||i===void 0?void 0:i.call(n)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$ES)===null||t===void 0||t.forEach(n=>{var i;return(i=n.hostDisconnected)===null||i===void 0?void 0:i.call(n)})}attributeChangedCallback(t,n,i){this._$AK(t,i)}_$EO(t,n,i=In){var o;const s=this.constructor._$Ep(t,i);if(s!==void 0&&i.reflect===!0){const r=(((o=i.converter)===null||o===void 0?void 0:o.toAttribute)!==void 0?i.converter:Qn).toAttribute(n,i.type);this._$El=t,r==null?this.removeAttribute(s):this.setAttribute(s,r),this._$El=null}}_$AK(t,n){var i;const o=this.constructor,s=o._$Ev.get(t);if(s!==void 0&&this._$El!==s){const r=o.getPropertyOptions(s),l=typeof r.converter=="function"?{fromAttribute:r.converter}:((i=r.converter)===null||i===void 0?void 0:i.fromAttribute)!==void 0?r.converter:Qn;this._$El=s,this[s]=l.fromAttribute(n,r.type),this._$El=null}}requestUpdate(t,n,i){let o=!0;t!==void 0&&(((i=i||this.constructor.getPropertyOptions(t)).hasChanged||So)(this[t],n)?(this._$AL.has(t)||this._$AL.set(t,n),i.reflect===!0&&this._$El!==t&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(t,i))):o=!1),!this.isUpdatePending&&o&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(n){Promise.reject(n)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((o,s)=>this[s]=o),this._$Ei=void 0);let n=!1;const i=this._$AL;try{n=this.shouldUpdate(i),n?(this.willUpdate(i),(t=this._$ES)===null||t===void 0||t.forEach(o=>{var s;return(s=o.hostUpdate)===null||s===void 0?void 0:s.call(o)}),this.update(i)):this._$Ek()}catch(o){throw n=!1,this._$Ek(),o}n&&this._$AE(i)}willUpdate(t){}_$AE(t){var n;(n=this._$ES)===null||n===void 0||n.forEach(i=>{var o;return(o=i.hostUpdated)===null||o===void 0?void 0:o.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){this._$EC!==void 0&&(this._$EC.forEach((n,i)=>this._$EO(i,this[i],n)),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}};st[ei]=!0,st.elementProperties=new Map,st.elementStyles=[],st.shadowRootOptions={mode:"open"},Oi==null||Oi({ReactiveElement:st}),((On=cn.reactiveElementVersions)!==null&&On!==void 0?On:cn.reactiveElementVersions=[]).push("1.6.3");var Tn;const un=window,pt=un.trustedTypes,Ii=pt?pt.createPolicy("lit-html",{createHTML:e=>e}):void 0,dn="$lit$",Ne=`lit$${(Math.random()+"").slice(9)}$`,ui="?"+Ne,Pr=`<${ui}>`,Ze=document,Nt=()=>Ze.createComment(""),Lt=e=>e===null||typeof e!="object"&&typeof e!="function",Ao=Array.isArray,Eo=e=>Ao(e)||typeof(e==null?void 0:e[Symbol.iterator])=="function",Nn=`[ 	
\f\r]`,_t=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ti=/-->/g,Ni=/>/g,Ge=RegExp(`>|${Nn}(?:([^\\s"'>=/]+)(${Nn}*=${Nn}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Li=/'/g,Mi=/"/g,Co=/^(?:script|style|textarea|title)$/i,jr=e=>(t,...n)=>({_$litType$:e,strings:t,values:n}),ye=jr(1),ke=Symbol.for("lit-noChange"),ae=Symbol.for("lit-nothing"),Hi=new WeakMap,Je=Ze.createTreeWalker(Ze,129,null,!1);function Po(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return Ii!==void 0?Ii.createHTML(t):t}const jo=(e,t)=>{const n=e.length-1,i=[];let o,s=t===2?"<svg>":"",r=_t;for(let l=0;l<n;l++){const c=e[l];let u,a,p=-1,f=0;for(;f<c.length&&(r.lastIndex=f,a=r.exec(c),a!==null);)f=r.lastIndex,r===_t?a[1]==="!--"?r=Ti:a[1]!==void 0?r=Ni:a[2]!==void 0?(Co.test(a[2])&&(o=RegExp("</"+a[2],"g")),r=Ge):a[3]!==void 0&&(r=Ge):r===Ge?a[0]===">"?(r=o??_t,p=-1):a[1]===void 0?p=-2:(p=r.lastIndex-a[2].length,u=a[1],r=a[3]===void 0?Ge:a[3]==='"'?Mi:Li):r===Mi||r===Li?r=Ge:r===Ti||r===Ni?r=_t:(r=Ge,o=void 0);const h=r===Ge&&e[l+1].startsWith("/>")?" ":"";s+=r===_t?c+Pr:p>=0?(i.push(u),c.slice(0,p)+dn+c.slice(p)+Ne+h):c+Ne+(p===-2?(i.push(void 0),l):h)}return[Po(e,s+(e[n]||"<?>")+(t===2?"</svg>":"")),i]};class Mt{constructor({strings:t,_$litType$:n},i){let o;this.parts=[];let s=0,r=0;const l=t.length-1,c=this.parts,[u,a]=jo(t,n);if(this.el=Mt.createElement(u,i),Je.currentNode=this.el.content,n===2){const p=this.el.content,f=p.firstChild;f.remove(),p.append(...f.childNodes)}for(;(o=Je.nextNode())!==null&&c.length<l;){if(o.nodeType===1){if(o.hasAttributes()){const p=[];for(const f of o.getAttributeNames())if(f.endsWith(dn)||f.startsWith(Ne)){const h=a[r++];if(p.push(f),h!==void 0){const g=o.getAttribute(h.toLowerCase()+dn).split(Ne),d=/([.?@])?(.*)/.exec(h);c.push({type:1,index:s,name:d[2],strings:g,ctor:d[1]==="."?Io:d[1]==="?"?To:d[1]==="@"?No:zt})}else c.push({type:6,index:s})}for(const f of p)o.removeAttribute(f)}if(Co.test(o.tagName)){const p=o.textContent.split(Ne),f=p.length-1;if(f>0){o.textContent=pt?pt.emptyScript:"";for(let h=0;h<f;h++)o.append(p[h],Nt()),Je.nextNode(),c.push({type:2,index:++s});o.append(p[f],Nt())}}}else if(o.nodeType===8)if(o.data===ui)c.push({type:2,index:s});else{let p=-1;for(;(p=o.data.indexOf(Ne,p+1))!==-1;)c.push({type:7,index:s}),p+=Ne.length-1}s++}}static createElement(t,n){const i=Ze.createElement("template");return i.innerHTML=t,i}}function Qe(e,t,n=e,i){var o,s,r,l;if(t===ke)return t;let c=i!==void 0?(o=n._$Co)===null||o===void 0?void 0:o[i]:n._$Cl;const u=Lt(t)?void 0:t._$litDirective$;return(c==null?void 0:c.constructor)!==u&&((s=c==null?void 0:c._$AO)===null||s===void 0||s.call(c,!1),u===void 0?c=void 0:(c=new u(e),c._$AT(e,n,i)),i!==void 0?((r=(l=n)._$Co)!==null&&r!==void 0?r:l._$Co=[])[i]=c:n._$Cl=c),c!==void 0&&(t=Qe(e,c._$AS(e,t.values),c,i)),t}class Oo{constructor(t,n){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var n;const{el:{content:i},parts:o}=this._$AD,s=((n=t==null?void 0:t.creationScope)!==null&&n!==void 0?n:Ze).importNode(i,!0);Je.currentNode=s;let r=Je.nextNode(),l=0,c=0,u=o[0];for(;u!==void 0;){if(l===u.index){let a;u.type===2?a=new mt(r,r.nextSibling,this,t):u.type===1?a=new u.ctor(r,u.name,u.strings,this,t):u.type===6&&(a=new Lo(r,this,t)),this._$AV.push(a),u=o[++c]}l!==(u==null?void 0:u.index)&&(r=Je.nextNode(),l++)}return Je.currentNode=Ze,s}v(t){let n=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(t,i,n),n+=i.strings.length-2):i._$AI(t[n])),n++}}class mt{constructor(t,n,i,o){var s;this.type=2,this._$AH=ae,this._$AN=void 0,this._$AA=t,this._$AB=n,this._$AM=i,this.options=o,this._$Cp=(s=o==null?void 0:o.isConnected)===null||s===void 0||s}get _$AU(){var t,n;return(n=(t=this._$AM)===null||t===void 0?void 0:t._$AU)!==null&&n!==void 0?n:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(t==null?void 0:t.nodeType)===11&&(t=n.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,n=this){t=Qe(this,t,n),Lt(t)?t===ae||t==null||t===""?(this._$AH!==ae&&this._$AR(),this._$AH=ae):t!==this._$AH&&t!==ke&&this._(t):t._$litType$!==void 0?this.g(t):t.nodeType!==void 0?this.$(t):Eo(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==ae&&Lt(this._$AH)?this._$AA.nextSibling.data=t:this.$(Ze.createTextNode(t)),this._$AH=t}g(t){var n;const{values:i,_$litType$:o}=t,s=typeof o=="number"?this._$AC(t):(o.el===void 0&&(o.el=Mt.createElement(Po(o.h,o.h[0]),this.options)),o);if(((n=this._$AH)===null||n===void 0?void 0:n._$AD)===s)this._$AH.v(i);else{const r=new Oo(s,this),l=r.u(this.options);r.v(i),this.$(l),this._$AH=r}}_$AC(t){let n=Hi.get(t.strings);return n===void 0&&Hi.set(t.strings,n=new Mt(t)),n}T(t){Ao(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let i,o=0;for(const s of t)o===n.length?n.push(i=new mt(this.k(Nt()),this.k(Nt()),this,this.options)):i=n[o],i._$AI(s),o++;o<n.length&&(this._$AR(i&&i._$AB.nextSibling,o),n.length=o)}_$AR(t=this._$AA.nextSibling,n){var i;for((i=this._$AP)===null||i===void 0||i.call(this,!1,!0,n);t&&t!==this._$AB;){const o=t.nextSibling;t.remove(),t=o}}setConnected(t){var n;this._$AM===void 0&&(this._$Cp=t,(n=this._$AP)===null||n===void 0||n.call(this,t))}}class zt{constructor(t,n,i,o,s){this.type=1,this._$AH=ae,this._$AN=void 0,this.element=t,this.name=n,this._$AM=o,this.options=s,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=ae}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,n=this,i,o){const s=this.strings;let r=!1;if(s===void 0)t=Qe(this,t,n,0),r=!Lt(t)||t!==this._$AH&&t!==ke,r&&(this._$AH=t);else{const l=t;let c,u;for(t=s[0],c=0;c<s.length-1;c++)u=Qe(this,l[i+c],n,c),u===ke&&(u=this._$AH[c]),r||(r=!Lt(u)||u!==this._$AH[c]),u===ae?t=ae:t!==ae&&(t+=(u??"")+s[c+1]),this._$AH[c]=u}r&&!o&&this.j(t)}j(t){t===ae?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class Io extends zt{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===ae?void 0:t}}const Or=pt?pt.emptyScript:"";class To extends zt{constructor(){super(...arguments),this.type=4}j(t){t&&t!==ae?this.element.setAttribute(this.name,Or):this.element.removeAttribute(this.name)}}class No extends zt{constructor(t,n,i,o,s){super(t,n,i,o,s),this.type=5}_$AI(t,n=this){var i;if((t=(i=Qe(this,t,n,0))!==null&&i!==void 0?i:ae)===ke)return;const o=this._$AH,s=t===ae&&o!==ae||t.capture!==o.capture||t.once!==o.once||t.passive!==o.passive,r=t!==ae&&(o===ae||s);s&&this.element.removeEventListener(this.name,this,o),r&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var n,i;typeof this._$AH=="function"?this._$AH.call((i=(n=this.options)===null||n===void 0?void 0:n.host)!==null&&i!==void 0?i:this.element,t):this._$AH.handleEvent(t)}}class Lo{constructor(t,n,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=n,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){Qe(this,t)}}const Ir={O:dn,P:Ne,A:ui,C:1,M:jo,L:Oo,R:Eo,D:Qe,I:mt,V:zt,H:To,N:No,U:Io,F:Lo},Ri=un.litHtmlPolyfillSupport;Ri==null||Ri(Mt,mt),((Tn=un.litHtmlVersions)!==null&&Tn!==void 0?Tn:un.litHtmlVersions=[]).push("2.8.0");const Tr=(e,t,n)=>{var i,o;const s=(i=n==null?void 0:n.renderBefore)!==null&&i!==void 0?i:t;let r=s._$litPart$;if(r===void 0){const l=(o=n==null?void 0:n.renderBefore)!==null&&o!==void 0?o:null;s._$litPart$=r=new mt(t.insertBefore(Nt(),l),l,void 0,n??{})}return r._$AI(e),r};var Ln,Mn;let Ue=class extends st{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,n;const i=super.createRenderRoot();return(t=(n=this.renderOptions).renderBefore)!==null&&t!==void 0||(n.renderBefore=i.firstChild),i}update(t){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=Tr(n,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),(t=this._$Do)===null||t===void 0||t.setConnected(!1)}render(){return ke}};Ue.finalized=!0,Ue._$litElement$=!0,(Ln=globalThis.litElementHydrateSupport)===null||Ln===void 0||Ln.call(globalThis,{LitElement:Ue});const zi=globalThis.litElementPolyfillSupport;zi==null||zi({LitElement:Ue});((Mn=globalThis.litElementVersions)!==null&&Mn!==void 0?Mn:globalThis.litElementVersions=[]).push("3.3.3");const $n=e=>t=>typeof t=="function"?((n,i)=>(customElements.define(n,i),i))(e,t):((n,i)=>{const{kind:o,elements:s}=i;return{kind:o,elements:s,finisher(r){customElements.define(n,r)}}})(e,t);const Nr=(e,t)=>t.kind==="method"&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(n){n.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){typeof t.initializer=="function"&&(this[t.key]=t.initializer.call(this))},finisher(n){n.createProperty(t.key,e)}},Lr=(e,t,n)=>{t.constructor.createProperty(n,e)};function pe(e){return(t,n)=>n!==void 0?Lr(e,t,n):Nr(e,t)}function Ve(e){return pe({...e,state:!0})}var Hn;((Hn=window.HTMLSlotElement)===null||Hn===void 0?void 0:Hn.prototype.assignedElements)!=null;const Ce={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Dt=e=>(...t)=>({_$litDirective$:e,values:t});class Bt{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,n,i){this._$Ct=t,this._$AM=n,this._$Ci=i}_$AS(t,n){return this.update(t,n)}update(t,n){return this.render(...n)}}const{I:Mr}=Ir,Mo=e=>e.strings===void 0,Di=()=>document.createComment(""),bt=(e,t,n)=>{var i;const o=e._$AA.parentNode,s=t===void 0?e._$AB:t._$AA;if(n===void 0){const r=o.insertBefore(Di(),s),l=o.insertBefore(Di(),s);n=new Mr(r,l,e,e.options)}else{const r=n._$AB.nextSibling,l=n._$AM,c=l!==e;if(c){let u;(i=n._$AQ)===null||i===void 0||i.call(n,e),n._$AM=e,n._$AP!==void 0&&(u=e._$AU)!==l._$AU&&n._$AP(u)}if(r!==s||c){let u=n._$AA;for(;u!==r;){const a=u.nextSibling;o.insertBefore(u,s),u=a}}}return n},We=(e,t,n=e)=>(e._$AI(t,n),e),Hr={},Ho=(e,t=Hr)=>e._$AH=t,Rr=e=>e._$AH,Rn=e=>{var t;(t=e._$AP)===null||t===void 0||t.call(e,!1,!0);let n=e._$AA;const i=e._$AB.nextSibling;for(;n!==i;){const o=n.nextSibling;n.remove(),n=o}};const Bi=(e,t,n)=>{const i=new Map;for(let o=t;o<=n;o++)i.set(e[o],o);return i},zr=Dt(class extends Bt{constructor(e){if(super(e),e.type!==Ce.CHILD)throw Error("repeat() can only be used in text expressions")}ct(e,t,n){let i;n===void 0?n=t:t!==void 0&&(i=t);const o=[],s=[];let r=0;for(const l of e)o[r]=i?i(l,r):r,s[r]=n(l,r),r++;return{values:s,keys:o}}render(e,t,n){return this.ct(e,t,n).values}update(e,[t,n,i]){var o;const s=Rr(e),{values:r,keys:l}=this.ct(t,n,i);if(!Array.isArray(s))return this.ut=l,r;const c=(o=this.ut)!==null&&o!==void 0?o:this.ut=[],u=[];let a,p,f=0,h=s.length-1,g=0,d=r.length-1;for(;f<=h&&g<=d;)if(s[f]===null)f++;else if(s[h]===null)h--;else if(c[f]===l[g])u[g]=We(s[f],r[g]),f++,g++;else if(c[h]===l[d])u[d]=We(s[h],r[d]),h--,d--;else if(c[f]===l[d])u[d]=We(s[f],r[d]),bt(e,u[d+1],s[f]),f++,d--;else if(c[h]===l[g])u[g]=We(s[h],r[g]),bt(e,s[f],s[h]),h--,g++;else if(a===void 0&&(a=Bi(l,g,d),p=Bi(c,f,h)),a.has(c[f]))if(a.has(c[h])){const w=p.get(l[g]),b=w!==void 0?s[w]:null;if(b===null){const A=bt(e,s[f]);We(A,r[g]),u[g]=A}else u[g]=We(b,r[g]),bt(e,s[f],b),s[w]=null;g++}else Rn(s[h]),h--;else Rn(s[f]),f++;for(;g<=d;){const w=bt(e,u[d+1]);We(w,r[g]),u[g++]=w}for(;f<=h;){const w=s[f++];w!==null&&Rn(w)}return this.ut=l,Ho(e,u),ke}});const Dr=Dt(class extends Bt{constructor(e){if(super(e),e.type!==Ce.PROPERTY&&e.type!==Ce.ATTRIBUTE&&e.type!==Ce.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!Mo(e))throw Error("`live` bindings can only contain a single expression")}render(e){return e}update(e,[t]){if(t===ke||t===ae)return t;const n=e.element,i=e.name;if(e.type===Ce.PROPERTY){if(t===n[i])return ke}else if(e.type===Ce.BOOLEAN_ATTRIBUTE){if(!!t===n.hasAttribute(i))return ke}else if(e.type===Ce.ATTRIBUTE&&n.getAttribute(i)===t+"")return ke;return Ho(e),t}});const Pt=(e,t)=>{var n,i;const o=e._$AN;if(o===void 0)return!1;for(const s of o)(i=(n=s)._$AO)===null||i===void 0||i.call(n,t,!1),Pt(s,t);return!0},fn=e=>{let t,n;do{if((t=e._$AM)===void 0)break;n=t._$AN,n.delete(e),e=t}while((n==null?void 0:n.size)===0)},Ro=e=>{for(let t;t=e._$AM;e=t){let n=t._$AN;if(n===void 0)t._$AN=n=new Set;else if(n.has(e))break;n.add(e),Fr(t)}};function Br(e){this._$AN!==void 0?(fn(this),this._$AM=e,Ro(this)):this._$AM=e}function Ur(e,t=!1,n=0){const i=this._$AH,o=this._$AN;if(o!==void 0&&o.size!==0)if(t)if(Array.isArray(i))for(let s=n;s<i.length;s++)Pt(i[s],!1),fn(i[s]);else i!=null&&(Pt(i,!1),fn(i));else Pt(this,e)}const Fr=e=>{var t,n,i,o;e.type==Ce.CHILD&&((t=(i=e)._$AP)!==null&&t!==void 0||(i._$AP=Ur),(n=(o=e)._$AQ)!==null&&n!==void 0||(o._$AQ=Br))};class Kr extends Bt{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,n,i){super._$AT(t,n,i),Ro(this),this.isConnected=t._$AU}_$AO(t,n=!0){var i,o;t!==this.isConnected&&(this.isConnected=t,t?(i=this.reconnected)===null||i===void 0||i.call(this):(o=this.disconnected)===null||o===void 0||o.call(this)),n&&(Pt(this,t),fn(this))}setValue(t){if(Mo(this._$Ct))this._$Ct._$AI(t,this);else{const n=[...this._$Ct._$AH];n[this._$Ci]=t,this._$Ct._$AI(n,this,0)}}disconnected(){}reconnected(){}}const zo=()=>new Vr;let Vr=class{};const zn=new WeakMap,Do=Dt(class extends Kr{render(e){return ae}update(e,[t]){var n;const i=t!==this.G;return i&&this.G!==void 0&&this.ot(void 0),(i||this.rt!==this.lt)&&(this.G=t,this.dt=(n=e.options)===null||n===void 0?void 0:n.host,this.ot(this.lt=e.element)),ae}ot(e){var t;if(typeof this.G=="function"){const n=(t=this.dt)!==null&&t!==void 0?t:globalThis;let i=zn.get(n);i===void 0&&(i=new WeakMap,zn.set(n,i)),i.get(this.G)!==void 0&&this.G.call(this.dt,void 0),i.set(this.G,e),e!==void 0&&this.G.call(this.dt,e)}else this.G.value=e}get rt(){var e,t,n;return typeof this.G=="function"?(t=zn.get((e=this.dt)!==null&&e!==void 0?e:globalThis))===null||t===void 0?void 0:t.get(this.G):(n=this.G)===null||n===void 0?void 0:n.value}disconnected(){this.rt===this.lt&&this.ot(void 0)}reconnected(){this.ot(this.lt)}});const ti=Dt(class extends Bt{constructor(e){var t;if(super(e),e.type!==Ce.ATTRIBUTE||e.name!=="class"||((t=e.strings)===null||t===void 0?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter(t=>e[t]).join(" ")+" "}update(e,[t]){var n,i;if(this.it===void 0){this.it=new Set,e.strings!==void 0&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter(s=>s!=="")));for(const s in t)t[s]&&!(!((n=this.nt)===null||n===void 0)&&n.has(s))&&this.it.add(s);return this.render(t)}const o=e.element.classList;this.it.forEach(s=>{s in t||(o.remove(s),this.it.delete(s))});for(const s in t){const r=!!t[s];r===this.it.has(s)||!((i=this.nt)===null||i===void 0)&&i.has(s)||(r?(o.add(s),this.it.add(s)):(o.remove(s),this.it.delete(s)))}return ke}});var Ut=function(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};let et=class extends Ue{constructor(){super(...arguments),this.placeholder="",this.hideBreadcrumbs=!1,this.breadcrumbHome="Home",this.breadcrumbs=[],this._inputRef=zo()}render(){let t="";if(!this.hideBreadcrumbs){const n=[];for(const i of this.breadcrumbs)n.push(ye`<button tabindex="-1" @click="${()=>this.selectParent(i)}" class="breadcrumb">${i}</button>`);t=ye`<div class="breadcrumb-list"><button tabindex="-1" @click="${()=>this.selectParent()}" class="breadcrumb">${this.breadcrumbHome}</button> ${n}</div>`}return ye`${t}<div part="ninja-input-wrapper" class="search-wrapper"><input part="ninja-input" type="text" id="search" spellcheck="false" autocomplete="off" @input="${this._handleInput}" ${Do(this._inputRef)} placeholder="${this.placeholder}" class="search"></div>`}setSearch(t){this._inputRef.value&&(this._inputRef.value.value=t)}focusSearch(){requestAnimationFrame(()=>this._inputRef.value.focus())}_handleInput(t){const n=t.target;this.dispatchEvent(new CustomEvent("change",{detail:{search:n.value},bubbles:!1,composed:!1}))}selectParent(t){this.dispatchEvent(new CustomEvent("setParent",{detail:{parent:t},bubbles:!0,composed:!0}))}firstUpdated(){this.focusSearch()}_close(){this.dispatchEvent(new CustomEvent("close",{bubbles:!0,composed:!0}))}};et.styles=bn`:host{flex:1;position:relative}.search{padding:1.25em;flex-grow:1;flex-shrink:0;margin:0;border:none;appearance:none;font-size:1.125em;background:0 0;caret-color:var(--ninja-accent-color);color:var(--ninja-text-color);outline:0;font-family:var(--ninja-font-family)}.search::placeholder{color:var(--ninja-placeholder-color)}.breadcrumb-list{padding:1em 4em 0 1em;display:flex;flex-direction:row;align-items:stretch;justify-content:flex-start;flex:initial}.breadcrumb{background:var(--ninja-secondary-background-color);text-align:center;line-height:1.2em;border-radius:var(--ninja-key-border-radius);border:0;cursor:pointer;padding:.1em .5em;color:var(--ninja-secondary-text-color);margin-right:.5em;outline:0;font-family:var(--ninja-font-family)}.search-wrapper{display:flex;border-bottom:var(--ninja-separate-border)}`;Ut([pe()],et.prototype,"placeholder",void 0);Ut([pe({type:Boolean})],et.prototype,"hideBreadcrumbs",void 0);Ut([pe()],et.prototype,"breadcrumbHome",void 0);Ut([pe({type:Array})],et.prototype,"breadcrumbs",void 0);et=Ut([$n("ninja-header")],et);class ni extends Bt{constructor(t){if(super(t),this.et=ae,t.type!==Ce.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(t){if(t===ae||t==null)return this.ft=void 0,this.et=t;if(t===ke)return t;if(typeof t!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.et)return this.ft;this.et=t;const n=[t];return n.raw=n,this.ft={_$litType$:this.constructor.resultType,strings:n,values:[]}}}ni.directiveName="unsafeHTML",ni.resultType=1;const Gr=Dt(ni);function*Wr(e,t){const n=typeof t=="function";if(e!==void 0){let i=-1;for(const o of e)i>-1&&(yield n?t(i):t),i++,yield o}}function Yr(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}const Xr=bn`:host{font-family:var(--mdc-icon-font, "Material Icons");font-weight:400;font-style:normal;font-size:var(--mdc-icon-size,24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}`;let ii=class extends Ue{render(){return ye`<span><slot></slot></span>`}};ii.styles=[Xr];ii=Yr([$n("mwc-icon")],ii);var wn=function(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};let ht=class extends Ue{constructor(){super(),this.selected=!1,this.hotKeysJoinedView=!0,this.addEventListener("click",this.click)}ensureInView(){requestAnimationFrame(()=>this.scrollIntoView({block:"nearest"}))}click(){this.dispatchEvent(new CustomEvent("actionsSelected",{detail:this.action,bubbles:!0,composed:!0}))}updated(t){t.has("selected")&&this.selected&&this.ensureInView()}render(){let t;this.action.mdIcon?t=ye`<mwc-icon part="ninja-icon" class="ninja-icon">${this.action.mdIcon}</mwc-icon>`:this.action.icon&&(t=Gr(this.action.icon||""));let n;this.action.hotkey&&(this.hotKeysJoinedView?n=this.action.hotkey.split(",").map(o=>{const s=o.split("+"),r=ye`${Wr(s.map(l=>ye`<kbd>${l}</kbd>`),"+")}`;return ye`<div class="ninja-hotkey ninja-hotkeys">${r}</div>`}):n=this.action.hotkey.split(",").map(o=>{const r=o.split("+").map(l=>ye`<kbd class="ninja-hotkey">${l}</kbd>`);return ye`<kbd class="ninja-hotkeys">${r}</kbd>`}));const i={selected:this.selected,"ninja-action":!0};return ye`<div class="ninja-action" part="ninja-action ${this.selected?"ninja-selected":""}" class="${ti(i)}">${t}<div class="ninja-title">${this.action.title}</div>${n}</div>`}};ht.styles=bn`:host{display:flex;width:100%}.ninja-action{padding:.75em 1em;display:flex;border-left:2px solid transparent;align-items:center;justify-content:start;outline:0;transition:color 0s ease 0s;width:100%}.ninja-action.selected{cursor:pointer;color:var(--ninja-selected-text-color);background-color:var(--ninja-selected-background);border-left:2px solid var(--ninja-accent-color);outline:0}.ninja-action.selected .ninja-icon{color:var(--ninja-selected-text-color)}.ninja-icon{font-size:var(--ninja-icon-size);max-width:var(--ninja-icon-size);max-height:var(--ninja-icon-size);margin-right:1em;color:var(--ninja-icon-color);margin-right:1em;position:relative}.ninja-title{flex-shrink:.01;margin-right:.5em;flex-grow:1;font-size:.8125em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ninja-hotkeys{flex-shrink:0;width:min-content;display:flex}.ninja-hotkeys kbd{font-family:inherit}.ninja-hotkey{background:var(--ninja-secondary-background-color);padding:.06em .25em;border-radius:var(--ninja-key-border-radius);text-transform:capitalize;color:var(--ninja-secondary-text-color);font-size:.75em;font-family:inherit}.ninja-hotkey+.ninja-hotkey{margin-left:.5em}.ninja-hotkeys+.ninja-hotkeys{margin-left:1em}`;wn([pe({type:Object})],ht.prototype,"action",void 0);wn([pe({type:Boolean})],ht.prototype,"selected",void 0);wn([pe({type:Boolean})],ht.prototype,"hotKeysJoinedView",void 0);ht=wn([$n("ninja-action")],ht);const Jr=ye`<div class="modal-footer" slot="footer"><span class="help"><svg version="1.0" class="ninja-examplekey" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1280 1280"><path d="M1013 376c0 73.4-.4 113.3-1.1 120.2a159.9 159.9 0 0 1-90.2 127.3c-20 9.6-36.7 14-59.2 15.5-7.1.5-121.9.9-255 1h-242l95.5-95.5 95.5-95.5-38.3-38.2-38.2-38.3-160 160c-88 88-160 160.4-160 161 0 .6 72 73 160 161l160 160 38.2-38.3 38.3-38.2-95.5-95.5-95.5-95.5h251.1c252.9 0 259.8-.1 281.4-3.6 72.1-11.8 136.9-54.1 178.5-116.4 8.6-12.9 22.6-40.5 28-55.4 4.4-12 10.7-36.1 13.1-50.6 1.6-9.6 1.8-21 2.1-132.8l.4-122.2H1013v110z"/></svg> to select </span><span class="help"><svg xmlns="http://www.w3.org/2000/svg" class="ninja-examplekey" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"/></svg> <svg xmlns="http://www.w3.org/2000/svg" class="ninja-examplekey" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"/></svg> to navigate </span><span class="help"><span class="ninja-examplekey esc">esc</span> to close </span><span class="help"><svg xmlns="http://www.w3.org/2000/svg" class="ninja-examplekey backspace" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6.707 4.879A3 3 0 018.828 4H15a3 3 0 013 3v6a3 3 0 01-3 3H8.828a3 3 0 01-2.12-.879l-4.415-4.414a1 1 0 010-1.414l4.414-4.414zm4 2.414a1 1 0 00-1.414 1.414L10.586 10l-1.293 1.293a1 1 0 101.414 1.414L12 11.414l1.293 1.293a1 1 0 001.414-1.414L13.414 10l1.293-1.293a1 1 0 00-1.414-1.414L12 8.586l-1.293-1.293z" clip-rule="evenodd"/></svg> move to parent</span></div>`,qr=bn`:host{--ninja-width:640px;--ninja-backdrop-filter:none;--ninja-overflow-background:rgba(255, 255, 255, 0.5);--ninja-text-color:rgb(60, 65, 73);--ninja-font-size:16px;--ninja-top:20%;--ninja-key-border-radius:0.25em;--ninja-accent-color:rgb(110, 94, 210);--ninja-secondary-background-color:rgb(239, 241, 244);--ninja-secondary-text-color:rgb(107, 111, 118);--ninja-selected-background:rgb(248, 249, 251);--ninja-icon-color:var(--ninja-secondary-text-color);--ninja-icon-size:1.2em;--ninja-separate-border:1px solid var(--ninja-secondary-background-color);--ninja-modal-background:#fff;--ninja-modal-shadow:rgb(0 0 0 / 50%) 0px 16px 70px;--ninja-actions-height:300px;--ninja-group-text-color:rgb(144, 149, 157);--ninja-footer-background:rgba(242, 242, 242, 0.4);--ninja-placeholder-color:#8e8e8e;font-size:var(--ninja-font-size);--ninja-z-index:1}:host(.dark){--ninja-backdrop-filter:none;--ninja-overflow-background:rgba(0, 0, 0, 0.7);--ninja-text-color:#7d7d7d;--ninja-modal-background:rgba(17, 17, 17, 0.85);--ninja-accent-color:rgb(110, 94, 210);--ninja-secondary-background-color:rgba(51, 51, 51, 0.44);--ninja-secondary-text-color:#888;--ninja-selected-text-color:#eaeaea;--ninja-selected-background:rgba(51, 51, 51, 0.44);--ninja-icon-color:var(--ninja-secondary-text-color);--ninja-separate-border:1px solid var(--ninja-secondary-background-color);--ninja-modal-shadow:0 16px 70px rgba(0, 0, 0, 0.2);--ninja-group-text-color:rgb(144, 149, 157);--ninja-footer-background:rgba(30, 30, 30, 85%)}.modal{display:none;position:fixed;z-index:var(--ninja-z-index);left:0;top:0;width:100%;height:100%;overflow:auto;background:var(--ninja-overflow-background);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-backdrop-filter:var(--ninja-backdrop-filter);backdrop-filter:var(--ninja-backdrop-filter);text-align:left;color:var(--ninja-text-color);font-family:var(--ninja-font-family)}.modal.visible{display:block}.modal-content{position:relative;top:var(--ninja-top);margin:auto;padding:0;display:flex;flex-direction:column;flex-shrink:1;-webkit-box-flex:1;flex-grow:1;min-width:0;will-change:transform;background:var(--ninja-modal-background);border-radius:.5em;box-shadow:var(--ninja-modal-shadow);max-width:var(--ninja-width);overflow:hidden}.bump{animation:zoom-in-zoom-out .2s ease}@keyframes zoom-in-zoom-out{0%{transform:scale(.99)}50%{transform:scale(1.01,1.01)}100%{transform:scale(1,1)}}.ninja-github{color:var(--ninja-keys-text-color);font-weight:400;text-decoration:none}.actions-list{max-height:var(--ninja-actions-height);overflow:auto;scroll-behavior:smooth;position:relative;margin:0;padding:.5em 0;list-style:none;scroll-behavior:smooth}.group-header{height:1.375em;line-height:1.375em;padding-left:1.25em;padding-top:.5em;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;font-size:.75em;line-height:1em;color:var(--ninja-group-text-color);margin:1px 0}.modal-footer{background:var(--ninja-footer-background);padding:.5em 1em;display:flex;border-top:var(--ninja-separate-border);color:var(--ninja-secondary-text-color)}.modal-footer .help{display:flex;margin-right:1em;align-items:center;font-size:.75em}.ninja-examplekey{background:var(--ninja-secondary-background-color);padding:.06em .25em;border-radius:var(--ninja-key-border-radius);color:var(--ninja-secondary-text-color);width:1em;height:1em;margin-right:.5em;font-size:1.25em;fill:currentColor}.ninja-examplekey.esc{width:auto;height:auto;font-size:1.1em}.ninja-examplekey.backspace{opacity:.7}`;var fe=function(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};let ue=class extends Ue{constructor(){super(...arguments),this.placeholder="Type a command or search...",this.disableHotkeys=!1,this.hideBreadcrumbs=!1,this.openHotkey="cmd+k,ctrl+k",this.navigationUpHotkey="up,shift+tab",this.navigationDownHotkey="down,tab",this.closeHotkey="esc",this.goBackHotkey="backspace",this.selectHotkey="enter",this.hotKeysJoinedView=!1,this.noAutoLoadMdIcons=!1,this.data=[],this.visible=!1,this._bump=!0,this._actionMatches=[],this._search="",this._flatData=[],this._headerRef=zo()}open(t={}){this._bump=!0,this.visible=!0,this._headerRef.value.focusSearch(),this._actionMatches.length>0&&(this._selected=this._actionMatches[0]),this.setParent(t.parent)}close(){this._bump=!1,this.visible=!1}setParent(t){t?this._currentRoot=t:this._currentRoot=void 0,this._selected=void 0,this._search="",this._headerRef.value.setSearch("")}get breadcrumbs(){var t;const n=[];let i=(t=this._selected)===null||t===void 0?void 0:t.parent;if(i)for(n.push(i);i;){const o=this._flatData.find(s=>s.id===i);o!=null&&o.parent&&n.push(o.parent),i=o?o.parent:void 0}return n.reverse()}connectedCallback(){super.connectedCallback(),this.noAutoLoadMdIcons||document.fonts.load("24px Material Icons","apps").then(()=>{}),this._registerInternalHotkeys()}disconnectedCallback(){super.disconnectedCallback(),this._unregisterInternalHotkeys()}_flattern(t,n){let i=[];return t||(t=[]),t.map(o=>{const s=o.children&&o.children.some(l=>typeof l=="string"),r={...o,parent:o.parent||n};return s||(r.children&&r.children.length&&(n=o.id,i=[...i,...r.children]),r.children=r.children?r.children.map(l=>l.id):[]),r}).concat(i.length?this._flattern(i,n):i)}update(t){t.has("data")&&!this.disableHotkeys&&(this._flatData=this._flattern(this.data),this._flatData.filter(n=>!!n.hotkey).forEach(n=>{re(n.hotkey,i=>{i.preventDefault(),n.handler&&n.handler(n)})})),super.update(t)}_registerInternalHotkeys(){this.openHotkey&&re(this.openHotkey,t=>{t.preventDefault(),this.visible?this.close():this.open()}),this.selectHotkey&&re(this.selectHotkey,t=>{this.visible&&(t.preventDefault(),this._actionSelected(this._actionMatches[this._selectedIndex]))}),this.goBackHotkey&&re(this.goBackHotkey,t=>{this.visible&&(this._search||(t.preventDefault(),this._goBack()))}),this.navigationDownHotkey&&re(this.navigationDownHotkey,t=>{this.visible&&(t.preventDefault(),this._selectedIndex>=this._actionMatches.length-1?this._selected=this._actionMatches[0]:this._selected=this._actionMatches[this._selectedIndex+1])}),this.navigationUpHotkey&&re(this.navigationUpHotkey,t=>{this.visible&&(t.preventDefault(),this._selectedIndex===0?this._selected=this._actionMatches[this._actionMatches.length-1]:this._selected=this._actionMatches[this._selectedIndex-1])}),this.closeHotkey&&re(this.closeHotkey,()=>{this.visible&&this.close()})}_unregisterInternalHotkeys(){this.openHotkey&&re.unbind(this.openHotkey),this.selectHotkey&&re.unbind(this.selectHotkey),this.goBackHotkey&&re.unbind(this.goBackHotkey),this.navigationDownHotkey&&re.unbind(this.navigationDownHotkey),this.navigationUpHotkey&&re.unbind(this.navigationUpHotkey),this.closeHotkey&&re.unbind(this.closeHotkey)}_actionFocused(t,n){this._selected=t,n.target.ensureInView()}_onTransitionEnd(){this._bump=!1}_goBack(){const t=this.breadcrumbs.length>1?this.breadcrumbs[this.breadcrumbs.length-2]:void 0;this.setParent(t)}render(){const t={bump:this._bump,"modal-content":!0},n={visible:this.visible,modal:!0},o=this._flatData.filter(l=>{var c;const u=new RegExp(this._search,"gi"),a=l.title.match(u)||((c=l.keywords)===null||c===void 0?void 0:c.match(u));return(!this._currentRoot&&this._search||l.parent===this._currentRoot)&&a}).reduce((l,c)=>l.set(c.section,[...l.get(c.section)||[],c]),new Map);this._actionMatches=[...o.values()].flat(),this._actionMatches.length>0&&this._selectedIndex===-1&&(this._selected=this._actionMatches[0]),this._actionMatches.length===0&&(this._selected=void 0);const s=l=>ye`${zr(l,c=>c.id,c=>{var u;return ye`<ninja-action exportparts="ninja-action,ninja-selected,ninja-icon" .selected="${Dr(c.id===((u=this._selected)===null||u===void 0?void 0:u.id))}" .hotKeysJoinedView="${this.hotKeysJoinedView}" @mouseover="${a=>this._actionFocused(c,a)}" @actionsSelected="${a=>this._actionSelected(a.detail)}" .action="${c}"></ninja-action>`})}`,r=[];return o.forEach((l,c)=>{const u=c?ye`<div class="group-header">${c}</div>`:void 0;r.push(ye`${u}${s(l)}`)}),ye`<div @click="${this._overlayClick}" class="${ti(n)}"><div class="${ti(t)}" @animationend="${this._onTransitionEnd}"><ninja-header exportparts="ninja-input,ninja-input-wrapper" ${Do(this._headerRef)} .placeholder="${this.placeholder}" .hideBreadcrumbs="${this.hideBreadcrumbs}" .breadcrumbs="${this.breadcrumbs}" @change="${this._handleInput}" @setParent="${l=>this.setParent(l.detail.parent)}" @close="${this.close}"></ninja-header><div class="modal-body"><div class="actions-list" part="actions-list">${r}</div></div><slot name="footer">${Jr}</slot></div></div>`}get _selectedIndex(){return this._selected?this._actionMatches.indexOf(this._selected):-1}_actionSelected(t){var n;if(this.dispatchEvent(new CustomEvent("selected",{detail:{search:this._search,action:t},bubbles:!0,composed:!0})),!!t){if(t.children&&((n=t.children)===null||n===void 0?void 0:n.length)>0&&(this._currentRoot=t.id,this._search=""),this._headerRef.value.setSearch(""),this._headerRef.value.focusSearch(),t.handler){const i=t.handler(t);i!=null&&i.keepOpen||this.close()}this._bump=!0}}async _handleInput(t){this._search=t.detail.search,await this.updateComplete,this.dispatchEvent(new CustomEvent("change",{detail:{search:this._search,actions:this._actionMatches},bubbles:!0,composed:!0}))}_overlayClick(t){var n;!((n=t.target)===null||n===void 0)&&n.classList.contains("modal")&&this.close()}};ue.styles=[qr];fe([pe({type:String})],ue.prototype,"placeholder",void 0);fe([pe({type:Boolean})],ue.prototype,"disableHotkeys",void 0);fe([pe({type:Boolean})],ue.prototype,"hideBreadcrumbs",void 0);fe([pe()],ue.prototype,"openHotkey",void 0);fe([pe()],ue.prototype,"navigationUpHotkey",void 0);fe([pe()],ue.prototype,"navigationDownHotkey",void 0);fe([pe()],ue.prototype,"closeHotkey",void 0);fe([pe()],ue.prototype,"goBackHotkey",void 0);fe([pe()],ue.prototype,"selectHotkey",void 0);fe([pe({type:Boolean})],ue.prototype,"hotKeysJoinedView",void 0);fe([pe({type:Boolean})],ue.prototype,"noAutoLoadMdIcons",void 0);fe([pe({type:Array,hasChanged(){return!0}})],ue.prototype,"data",void 0);fe([Ve()],ue.prototype,"visible",void 0);fe([Ve()],ue.prototype,"_bump",void 0);fe([Ve()],ue.prototype,"_actionMatches",void 0);fe([Ve()],ue.prototype,"_search",void 0);fe([Ve()],ue.prototype,"_currentRoot",void 0);fe([Ve()],ue.prototype,"_flatData",void 0);fe([Ve()],ue.prototype,"breadcrumbs",null);fe([Ve()],ue.prototype,"_selected",void 0);ue=fe([$n("ninja-keys")],ue);var Zr=G("<ninja-keys>",!0,!1);const Qr=e=>(()=>{var t=Zr();return t._$owner=Qo(),X(n=>{var i=e.hotkeys,o=e.placeholder,s=e.disableHotkeys,r=e.hideBreadcrumbs,l=e.openHotkey,c=e.navigationUpHotkey,u=e.navigationDownHotkey,a=e.closeHotkey,p=e.goBackHotkey,f=e.selectHotkey,h=e.hotKeysJoinedView,g=e.noAutoLoadMdIcons,d=e.isDark?"dark":"light";return i!==n.e&&(t.data=n.e=i),o!==n.t&&(t.placeholder=n.t=o),s!==n.a&&(t.disablehotkeys=n.a=s),r!==n.o&&(t.hidebreadcrumbs=n.o=r),l!==n.i&&(t.openhotkey=n.i=l),c!==n.n&&(t.navigationuphotkey=n.n=c),u!==n.s&&(t.navigationdownhotkey=n.s=u),a!==n.h&&(t.closehotkey=n.h=a),p!==n.r&&(t.gobackhotkey=n.r=p),f!==n.d&&(t.selecthotkey=n.d=f),h!==n.l&&(t.hotkeysjoinedview=n.l=h),g!==n.u&&(t.noautoloadmdicons=n.u=g),d!==n.c&&ds(t,n.c=d),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),t})(),el=Qr;function tl(){let e;return at(()=>{e=document.querySelector("ninja-keys")}),{open:o=>{e==null||e.open(o?{parent:o}:void 0)},close:()=>{e==null||e.close()},setParent:o=>{e==null||e.setParent(o)}}}var nl=G("<div class=helpPopup><div class=close>❌</div><div class=header>Help</div><div class=modalContent><div class=help><div class=info><div class=title></div><div class=text></div></div></div><ul class=menu>"),il=G("<video class=video>"),ol=G("<li class=help>");const sl=e=>{const[t,n]=ee(0),i=[...["Tweak prompts","Temporarily disable phrases","Tweak variables","Hotkey change numerical values","Prompt weights","Pin images","Assign to variables","Convert links easily","Align blocks","Shift drag for quick access","Show links between","Jump between sibling nodes","Jump to assigment","Search for node names and jump","Batch rename variables","Help section","How to get started"].map(s=>({name:s,video:"https://im.ma.pe/20bfea638130d57040802b6f011dcdd5.mp4",text:`You can access ${s} by clicking the menu in the top right.`}))],o=()=>i[t()];return(()=>{var s=nl(),r=s.firstChild,l=r.nextSibling,c=l.nextSibling,u=c.firstChild,a=u.firstChild,p=a.firstChild,f=p.nextSibling,h=u.nextSibling;return ri(r,"click",e.close,!0),U(u,(()=>{var g=le(()=>!!o().video);return()=>g()?(()=>{var d=il();return d.muted=!0,d.autoplay=!0,d.controls=!0,X(()=>ge(d,"src",o().video)),d})():null})(),a),U(p,()=>o().name),U(f,()=>o().text),U(h,()=>i.map((g,d)=>(()=>{var w=ol();return w.$$click=()=>{n(d)},U(w,()=>g.name),X(()=>w.classList.toggle("active",d===t())),w})())),s})()};tt(["click"]);function rl(e,t){let n=t;for(;n!==null;){if(n===e)return!0;n=n.parentElement}return!1}function ll(e){return e.filter((t,n,i)=>i.indexOf(t)===n)}var al=G("<div class=mapeConfirmPrompt><div class=title></div><input type=text><div class=suggestions>"),cl=G("<div class=suggestion>");const ul=({title:e,position:t,callback:n,exit:i,fallback:o})=>{const[s,r]=ee(-1);let l,c;at(()=>{c.focus(),c.select()});const[u,a]=ee(""),[p]=ee(ll(gn().map(d=>Y(d,0)))),f=d=>{rl(l,d.target)||i()},h=d=>{if(d.key==="ArrowUp"||d.key==="ArrowDown"){d.preventDefault(),d.key==="ArrowUp"&&r(s()-1),d.key==="ArrowDown"&&r(s()+1),s()<0&&r(0),s()>p().length-1&&r(p().length-1),c.select();return}if(d.key==="Enter"){s()!==-1&&a(p().filter(g)[s()]),n((u()||o)??"");return}if(d.key==="Escape"){i();return}r(-1)};at(()=>{document.body.addEventListener("click",f),document.body.addEventListener("keyup",h)}),jt(()=>{document.body.removeEventListener("click",f),document.body.removeEventListener("keyup",h)});const g=d=>u().trim()===""?!0:d.match(new RegExp(u(),"i"));return(()=>{var d=al(),w=d.firstChild,b=w.nextSibling,A=b.nextSibling,y=l;typeof y=="function"?kt(y,d):l=d,U(w,e),b.$$keyup=k=>{k.key!=="Shift"&&a(k.currentTarget.value)};var $=c;return typeof $=="function"?kt($,b):c=b,ge(b,"placeholder",o),U(A,()=>p().filter(g).map((k,j)=>(()=>{var R=cl();return R.$$click=()=>{n(k)},U(R,k),X(()=>R.classList.toggle("selected",s()===j)),R})())),X(k=>{var j=`${t.x}px`,R=`${t.y}px`;return j!==k.e&&((k.e=j)!=null?d.style.setProperty("left",j):d.style.removeProperty("left")),R!==k.t&&((k.t=R)!=null?d.style.setProperty("top",R):d.style.removeProperty("top")),k},{e:void 0,t:void 0}),X(()=>b.value=u()),d})()};tt(["keyup","click"]);const Dn=()=>{const e=document.activeElement;return e.tagName==="INPUT"&&(e.type==="text"||e.type==="number")||e.tagName==="TEXTAREA"},dl=e=>{var s,r;const t=(r=(s=e.inputs)==null?void 0:s[0])==null?void 0:r.link;if(!e.graph||!t)return;const n=$e(t);if(!n)return;const i=n.origin_id;return oe(i)},oi=(e,t)=>{const n=Pe().filter(ie);return(t==="get"?n.filter(ct):n.filter(be)).filter(o=>Y(o)===e)},fl=e=>{var o,s,r,l,c;let t,n,i;for(const u of graph._nodes){if(u.type!==Me||Y(u)!==e||!u.graph)continue;const a=(s=(o=u.inputs)==null?void 0:o[0])==null?void 0:s.link;if(!a)continue;const p=$e(a);if(typeof p>"u")continue;const f=p.origin_id;if(typeof f>"u")continue;const h=p.origin_slot;if(typeof h>"u")continue;const g=u.graph.getNodeById(f);if(!g)continue;if(g.outputs[h]&&g.outputs[h].type==="IMAGE"){let w;for(const b of graph._nodes){if(!ie(b)||Y(b)!==e||be(b))continue;const A=(l=(r=b.outputs)==null?void 0:r[0].links)==null?void 0:l[0];if(typeof A>"u")continue;const y=$e(A);if(!y)continue;const $=y.target_id,k=u.graph.getNodeById($);k&&(c=k.type)!=null&&c.match(/(PreviewImage|SaveImage)/)&&(w=k.images)}return n=g.id,t=w,i=u.id,[w,n,i]}if(typeof g>"u"||!g.widgets)continue;const d=g.widgets[h];typeof d>"u"||(n=g.id,i=u.id,t=d.value)}return[t,n,i]},pl=()=>{const e=Object.keys(Object.fromEntries(Qi().map(t=>[Y(t),!0])));for(const t of e){const n=oi(t,"set")[0];if(!n)continue;const i=n.inputs[0].link;if(!i)continue;const{origin_id:o,origin_slot:s}=$e(i),r=oe(o);if(!r)continue;const l=oi(t,"get");for(const c of l){for(const u of c.outputs)if(u.links)for(const a of u.links){const{target_id:p,target_slot:f}=$e(a),h=oe(p);try{r.connect(s,h,f)}catch(g){console.error(g)}}Et(c)}Et(n)}for(const t of gn())Et(t)},hl=e=>{const t=eo().find(n=>n.title===e);t&&yo([t.pos[0]+t.size[0]/2,t.pos[1]+t.size[1]/2],graph.list_of_graphcanvas[0])},$t=e=>{for(const t of Pe())t.type!==Me||!be(t)||Y(t)!==e||dt(t)},Ui=e=>{const t=oe(e);t&&dt(t)},gl=()=>{const e=St(Object.values(_n()).filter(Boolean)),t={},n={};for(const i of Pe().filter(ie)){const o=Y(i);if(i.inputs[0].link){const r=e.find(a=>{const{target_id:p}=a;return p===i.id});if(!r)continue;const{id:l,origin_id:c,origin_slot:u}=r;n[o]={id:l,originId:c,originSlot:u};continue}else{t[o]||(t[o]=[]);const r=e.find(a=>{const{origin_id:p}=a;return p===i.id});if(!r)continue;const{id:l,target_id:c,target_slot:u}=r;t[o].push({id:l,targetId:c,targetSlot:u})}}return{nodeSet:n,nodeGet:t}},ml=()=>{var u;let e=[];const t=[],n={},i={},o={},s=gl(),r=_n();for(const a of Pe().filter(p=>!ie(p))){n[a.id]=a;let p=0;if(a.inputs)for(let f=0,h=a.inputs.length;f<h;f++)a.inputs[f]&&a.inputs[f].link!=null&&(p+=1);p==0?t.push(a):o[a.id]=p}let l=!1;for(;!l;){if(t.length==0){l=!0;break}const a=t.shift();if(e.push(a),delete n[a.id],!!a.outputs)for(let p=0;p<a.outputs.length;p++){const f=a.outputs[p],h=(u=f.links)==null?void 0:u.flatMap(d=>{const w=r[d],b=oe(w.target_id);if(!b)return d;if(ie(b)){const A=Y(b);return s.nodeGet[A]?s.nodeGet[A].map($=>$.id):d}return d});if(!(!f||!h||f==null||h==null||h.length==0))for(let d=0;d<h.length;d++){const w=h[d],b=r[w];if(!b||i[b.id])continue;const y=oe(b.target_id);if(y==null){i[b.id]=!0;continue}i[b.id]=!0,o[y.id]-=1,o[y.id]===0&&t.push(y)}}}for(const a in n)e.push(n[a]);const c=e.length;for(let a=0;a<c;++a)e[a].order=a;e=e.sort((a,p)=>{const f=a.constructor.priority||a.priority||0,h=p.constructor.priority||p.priority||0;return f===h?a.order-p.order:f-h});for(let a=0;a<c;++a)e[a].order=a;return e},vl=()=>{const e=ml();let t=50;for(const s of e)s.pos=[700,t],t+=10;const n=Math.min(...e.map(s=>s.pos[1])),i=te("nodeAlignOffsetY");let o=0;for(const s of e.sort((r,l)=>r.pos[1]-l.pos[1])){s.pos=[s.pos[0],n+o];const r=s.size[1]+i;o+=r}an(e,!1),app.graph.setDirtyCanvas(!0,!0)},yl=()=>{Object.values(_n()).filter(Boolean).map(e=>{mo(e,!0)}),an(Pe())},_l=e=>{const t=document.createElement("style");return t.appendChild(document.createTextNode(e)),t},ze=(e,t)=>{var n,i,o;for(const s of graph._nodes){if(s.type!==Me||Y(s)!==e||!s.inputs[0])continue;const r=(i=(n=s.inputs)==null?void 0:n[0])==null?void 0:i.link;if(r===null)continue;const l=$e(r);if(typeof l>"u")continue;const c=l.origin_id;if(typeof c>"u")continue;const u=l.origin_slot;if(typeof u>"u"||!s.graph)continue;const a=s.graph.getNodeById(c);if(typeof a>"u")continue;const p=(o=a.widgets)==null?void 0:o[u];typeof p>"u"||(p.options&&p.options.setValue?typeof t=="function"?p.options.setValue(t(p.value)):p.options.setValue(t):typeof t=="function"?p.value=t(p.value):p.value=t,app.graph.setDirtyCanvas(!0,!0),vo())}};var bl=G("<div class=warningsPopup><div class=close>❌</div><div class=header>Warnings</div><div class=modalContent><div class=mapeSettings>"),$l=G("<div class=mapeSetting><label class=name><small></small></label><button>Jump to node");const wl=e=>(()=>{var t=bl(),n=t.firstChild,i=n.nextSibling,o=i.nextSibling,s=o.firstChild;return ri(n,"click",e.close,!0),U(s,()=>e.warnings.map(r=>(()=>{var l=$l(),c=l.firstChild,u=c.firstChild,a=c.nextSibling;return U(c,(()=>{var p=le(()=>!!ie(r.node));return()=>{var f,h;return p()?Y(r.node):`${((f=r.node)==null?void 0:f.title)??((h=r.node)==null?void 0:h.type)}: ${r.type}`}})(),u),U(u,()=>r.text),a.$$click=()=>{dt(r.node)},l})())),t})();tt(["click"]);var kl=G('<div class="tweak numberWrapper"><label></label><div class=value><input type=number step=1>'),xl=G('<div class="tweak numberWrapper"><label></label><div class=value><input type=number step=0.1>'),Sl=G('<div class="tweak stringContainer"><label class=interactable></label><div class=value>'),Al=G("<textarea>"),El=G("<input type=text>"),Cl=G('<div class="tweak imageContainer"><label>'),Pl=G("<div class=thumbnails>"),jl=G("<img class=fullImage>"),Ol=G("<div class=thumb><img class=smallImage>"),Il=G("<div class=missing>"),Tl=G("<div class=value>"),Nl=G("<div class=missingImage>?"),Ll=G("<div class=image>"),Ml=G('<div class="tweak defaultContainer"><label>'),Hl=G('<div class=mapeRoot><div class=mapeBar><div class=logo title=https://twitter.com/mape></div><div class=tweaks></div><div class=options><div class=warnings title="Organize workflow (Hold Shift-key to skip prompt)">✨</div><div class=warnings title="Convert links to set/get (Hold Shift-key to skip prompt)">💥</div><div class=warnings title="Convert set/get to links (Hold Shift-key to skip prompt)">🩹</div><div class=imagePreview title="Open separate window for image previews">🖥️<small>🎨</small></div><div class=clear title="Clear favourites">❌</div><div class=settings title=Settings>⚙️</div></div></div><div>'),Rl=G("<div class=tweakHighlight>"),zl=G('<div class="warnings blink"title="Show potentially broken nodes">⚠️');const Dl=()=>{const[e,t]=ee([]),[n,i]=sn({}),[o,s]=sn({}),[r,l]=ee([]),[c,u]=ee(!1),[a,p]=ee(!1),[f,h]=ee(!1),g=()=>{const v=[],m={},_=Pe().filter(ie);for(const E of _.filter(be)){const C=Y(E);m[C]||(m[C]=0),m[C]+=1;const H=dl(E);if(H&&ie(H)){const N=Y(H);C===N&&v.push({node:E,text:"Can't point a set to a get of itself"})}}for(const E of _.filter(ct)){const C=Y(E);C&&typeof m[C]>"u"&&v.push({node:E,text:"Missing set node"})}for(const E of _.filter(be)){const C=Y(E);m[C]&&m[C]>1&&v.push({text:"Can't have multiple set nodes of the same name",node:E})}l([...window.mapeErrors??[],...v])};Ae(()=>{r().length===0&&h(!1)});const d=setInterval(g,1e3);jt(()=>{clearInterval(d)});const w=()=>{i(Yn(Object.fromEntries(Object.entries(localStorage).filter(([v])=>v.startsWith(Ft)).map(([v,m])=>{const _=v.replace(Ft,""),[E,C,H]=fl(_),N=oe(H);if(!N)return null;const z=N!=null&&N.pos?[N==null?void 0:N.pos[0],N==null?void 0:N.pos[1]]:[Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER];return[_,{name:_,type:m,value:E,pos:z}]}).filter(Boolean)))),localStorage[xt]=JSON.stringify(Object.fromEntries(Object.entries(n).filter(([,v])=>v.type==="IMAGE")))};at(w),window.addEventListener("mapeTweak",w);const b=v=>{const m=(v??0).toString().length*6+35;return`${Math.max(55,m)}px`},A={INT:v=>(()=>{var m=kl(),_=m.firstChild,E=_.nextSibling,C=E.firstChild;return m.addEventListener("wheel",H=>{const N=H.deltaY>0?-1:1;ze(v.name,z=>z+N)}),m.$$click=H=>{if(H.shiftKey)return $t(v.name)},U(_,()=>v.name),C.$$input=H=>{const N=parseInt(H.currentTarget.value,10);i(v.name,"value",N),ze(v.name,N)},X(()=>b(v.value)!=null?E.style.setProperty("width",b(v.value)):E.style.removeProperty("width")),X(()=>C.value=v.value),m})(),FLOAT:v=>{const m=_=>typeof _<"u"?parseFloat(parseFloat(_.toString()).toFixed(3)):0;return(()=>{var _=xl(),E=_.firstChild,C=E.nextSibling,H=C.firstChild;return _.addEventListener("wheel",N=>{const z=N.deltaY>0?-.1:.1;ze(v.name,v.value+z)}),_.$$click=N=>{if(N.shiftKey)return $t(v.name)},U(E,()=>v.name),H.$$input=N=>{const z=parseFloat(N.currentTarget.value);i(v.name,"value",z),ze(v.name,z)},X(()=>b(m(v.value))!=null?C.style.setProperty("width",b(m(v.value))):C.style.removeProperty("width")),X(()=>H.value=m(v.value)),_})()},STRING:v=>{const[m,_]=ee(o[v.name]??!1),E=C=>{const H=C.currentTarget.value;i(v.name,"value",H),ze(v.name,H)};return(()=>{var C=Sl(),H=C.firstChild,N=H.nextSibling;return H.$$click=z=>{if(z.shiftKey)return $t(v.name);_(!m())},U(H,()=>v.name),U(N,(()=>{var z=le(()=>!!m());return()=>z()?[(()=>{var S=Al();return S.$$input=E,X(()=>S.value=v.value),S})(),he(qs,{get prompt(){return v.value},update:S=>{ze(v.name,S)}})]:(()=>{var S=El();return S.$$input=E,S.addEventListener("focus",()=>{_(!0)}),X(()=>S.value=v.value),S})()})()),X(()=>C.classList.toggle("focused",!!m())),C})()},IMAGE:v=>{const[m,_]=ee(!1),[E,C]=ee(0);Ae(()=>{const S=document.querySelector(".comfy-menu");S&&(m()?S.style.display="none":S.style.display="block")});const H=()=>`mape_tweak_image_cache_${v.name}`;Ae(()=>{v.value&&(sessionStorage[H()]=JSON.stringify(v.value))});const N=()=>`Connect "${v.name}" variable to a Preview Image node or Regenerate the image`,z=()=>v.value??(sessionStorage[H()]?JSON.parse(sessionStorage[H()]):void 0);return(()=>{var S=Cl(),J=S.firstChild;return S.$$click=K=>{if(K.shiftKey)return $t(v.name);K.target.tagName==="IMG"||K.target.className==="thumbnails"||K.target.className==="thumb"||(_(!m()),m()||C(0))},U(J,()=>v.name),U(S,(()=>{var K=le(()=>!!m());return()=>K()?(()=>{var V=le(()=>!!z());return()=>V()?[(()=>{var O=Pl();return U(O,()=>(z()??[]).map((W,Z)=>(()=>{var Q=Ol(),me=Q.firstChild;return Q.$$click=()=>{C(Z)},X(()=>ge(me,"src",Be(W))),Q})())),O})(),(()=>{var O=jl();return X(()=>{var W;return ge(O,"src",Be((W=z())==null?void 0:W[E()]))}),O})()]:(()=>{var O=Il();return U(O,N),O})()})():(()=>{var V=Tl();return U(V,(()=>{var O=le(()=>!!z());return()=>O()?"":(()=>{var W=Nl();return X(()=>ge(W,"title",N())),W})()})(),null),U(V,()=>(z()??[]).map(O=>{const W=`url("${Be(O)}")`;return(()=>{var Z=Ll();return W!=null?Z.style.setProperty("background-image",W):Z.style.removeProperty("background-image"),Z})()}),null),V})()})(),null),X(K=>{var V=!!m(),O=(z()??[]).length>1;return V!==K.e&&S.classList.toggle("focused",K.e=V),O!==K.t&&S.classList.toggle("hasMultiple",K.t=O),K},{e:void 0,t:void 0}),S})()},DEFAULT:v=>(()=>{var m=Ml(),_=m.firstChild;return m.$$click=E=>{if(E.shiftKey)return $t(v.name)},U(_,()=>v.name),X(()=>ge(m,"title",JSON.stringify(v,null,"  "))),m})()},[y,$]=ee([]),{open:k}=tl();at(()=>{const v=document.querySelector("ninja-keys");v&&v.shadowRoot.appendChild(_l(`
			* {
				will-change: unset !important;
				&::-webkit-scrollbar {
					width: 5px;
					height: 5px;
					background: linear-gradient(to right, #111, #222);
				}
				&::-webkit-scrollbar-thumb {
					background: linear-gradient(to bottom, #fff, #aaa);
					border: 1px solid #fff;
					border-radius: 10px;
				}
			}
			`))});const j=v=>{if(v.key==="P"&&v.shiftKey){if(Dn())return;k(),$([...Pe().filter(m=>{var _,E;return m.type!=="mape Variable"||m.type==="mape Variable"&&((E=(_=m.inputs)==null?void 0:_[0])==null?void 0:E.type)!=="*"}).map(m=>m.type==="mape Variable"?{id:m.id,title:`Jump to variable: ${Y(m)??m.title??m.type} (${m.id})`,mdIcon:"timeline",handler:()=>{Ui(m.id)}}:{id:m.id,title:`Jump to node: ${m.title??m.type} (${m.id}) ${m.widgets_values&&Array.isArray(m.widgets_values)?` - ${m.widgets_values.join(", ")}`:""}`.slice(0,90),mdIcon:"circle",handler:()=>{Ui(m.id)}}),...eo().map(m=>({title:`Jump to group: ${m.title}`,mdIcon:"workspaces",handler:()=>{hl(m.title)}}))])}},R=[],[L,B]=ee({1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1}),q=v=>Object.fromEntries(Object.keys(L()).map((m,_)=>[m,v===_]));at(()=>{document.body.addEventListener("keydown",j);for(const v of[1,2,3,4,5,6,7,8,9])for(const m of["up","down"]){const _=`${v}+${m}`;re(_,()=>{if(Dn())return;const E=P()[v-1];if(!E)return;const C=E.type;if(C==="INT"){const H=m==="up"?1:-1;ze(E.name,E.value+H)}if(C==="FLOAT"){const H=m==="up"?.1:-.1;ze(E.name,E.value+H)}}),R.push(()=>{re.unbind(_)})}});const I=v=>{if(Dn())return;const m=v.key.match(/^\d+$/);if(m){const _=P()[parseInt(m[0],10)-1];if(!_)return;_.type==="STRING"?s(_.name,!o[_.name]):B(q(parseFloat(v.key)-1))}},x=v=>{v.key.match(/^\d+$/)&&B(q(-1))};document.body.addEventListener("keypress",I),document.body.addEventListener("keyup",x),jt(()=>{document.body.addEventListener("keydown",j);for(const v of R)v();document.body.removeEventListener("keypress",I),document.body.removeEventListener("keyup",x)});const[T,D]=ee([]);window.setPrompt=(v,m,_,E)=>{const C=Math.random(),H=()=>{D(T().filter(N=>N.id!==C))};D([...T(),{callback:N=>(_(N),H(),setTimeout(()=>{app.graph.setDirtyCanvas(!0,!0)}),!0),exit:()=>{H()},position:{x:m[0],y:m[1]},title:v,id:C,fallback:E}])};const M=le(()=>Object.values(L()).filter(Boolean).length>0),P=le(()=>Object.values(n).sort(to(n))),F=()=>{const v=window.open("","_blank","width=1280,height=720,location=no,toolbar=no,menubar=no");if(v.document.write(`
		<!DOCTYPE html>
		<html lang="en">
			<head>
				<meta charset="UTF-8" />
				<title>mape's Helpers - Image Preview</title>
			</head>
			<body>
				<script>
					window.standaloneImagePreview = true;
					import('/extensions/ComfyUI-mape-Helpers/tweak/mape-helpers.js');
				<\/script>
			</body>
		</html>
		`),v){let m=!0;v.addEventListener("unload",()=>{if(m){m=!1;return}t([...e().filter(_=>_!==v)])}),t([...e(),v])}else console.error("Failed to open a new window.")};return window.showWarnings=(v=!0)=>{h(v)},(()=>{var v=Hl(),m=v.firstChild,_=m.firstChild,E=_.nextSibling,C=E.nextSibling,H=C.firstChild,N=H.nextSibling,z=N.nextSibling,S=z.nextSibling,J=S.nextSibling,K=J.nextSibling,V=m.nextSibling;return _.$$click=w,U(E,he(Ji,{get each(){return P()},children:(O,W)=>(()=>{var Z=Rl();return U(Z,(()=>{var Q=le(()=>!!(A[O.type]&&typeof O.value<"u"));return()=>Q()?A[O.type](O):A.DEFAULT(O)})()),X(Q=>{var me=!!L()[W()+1],Ee=!!M();return me!==Q.e&&Z.classList.toggle("active",Q.e=me),Ee!==Q.t&&Z.classList.toggle("siblingActive",Q.t=Ee),Q},{e:void 0,t:void 0}),Z})()})),H.$$click=O=>{(O.shiftKey||confirm("Do you want to organize workflow?"))&&vl()},N.$$click=O=>{(O.shiftKey||confirm("Do you want to convert all links to set/get nodes?"))&&yl()},z.$$click=O=>{(O.shiftKey||confirm(`Do you want to convert all set/get nodes to connections?
This is finicky with PrimitiveNodes...`))&&pl()},U(C,(()=>{var O=le(()=>r().length>0);return()=>O()?(()=>{var W=zl();return W.$$click=()=>{h(!f())},W})():null})(),S),S.$$click=()=>{F()},J.$$click=()=>{if(confirm("Clear all favourites?")){for(const O of Object.keys(localStorage))if(O.startsWith(Ft)){const W=O.replace(Ft,"");for(const Z of oi(W,"set"))we(Z,!1,1);delete localStorage[O]}w()}},K.$$click=()=>{p(!a()),a()&&u(!1)},V.style.setProperty("--ninja-font-family","Arial"),V.style.setProperty("position","relative"),V.style.setProperty("z-index","23"),U(V,he(el,{isDark:!0,get hotkeys(){return y()}})),U(v,()=>T().map(O=>he(ul,O)),null),U(v,(()=>{var O=le(()=>!!a());return()=>O()?he(or,{close:()=>{p(!1)}}):null})(),null),U(v,(()=>{var O=le(()=>!!c());return()=>O()?he(sl,{close:()=>{u(!1)}}):null})(),null),U(v,(()=>{var O=le(()=>!!f());return()=>O()?he(wl,{get warnings(){return r()},close:()=>{window.mapeErrors=[],h(!1)}}):null})(),null),v})()};tt(["click","input"]);const Bl=Object.freeze(Object.defineProperty({__proto__:null,MapeTweak:Dl},Symbol.toStringTag,{value:"Module"}));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=mape-helpers.js.map
(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@import"https://fonts.googleapis.com/css?family=Material+Icons&display=block";.imagePreviews{background:repeating-radial-gradient(#181818 0,#181818 4px,#1f1f1f 5px,#1f1f1f 5px);font-family:arial;color:#fff;position:fixed;top:0;left:0;right:0;bottom:0;z-index:1000;margin:0;background-size:10px 10px;display:flex;flex-direction:column}.imagePreviews .content{display:flex;height:100%}.imagePreviews .image{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%}.imagePreviews .imagePreviewTweaks{display:flex;background:#111;padding:10px;justify-content:space-around;border-bottom:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px inset #00000080;gap:10px}.imagePreviews .imagePreviewTweaks .button{flex:auto;vertical-align:top;border:0;text-transform:uppercase;text-shadow:2px 2px 1px #000000;-webkit-user-select:none;user-select:none;position:relative;display:inline-block;color:#fff;border-top:1px solid #0f0f12;background:#0f0f0f;margin:2px;border-radius:4px;cursor:pointer;line-height:1;transition:color 1s;outline:none;text-align:center;opacity:.5;padding:8px 10px}.imagePreviews .imagePreviewTweaks .button.active{background:#490000}.imagePreviews .imagePreviewTweaks .button:before{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:4px;background:linear-gradient(to bottom,#ffffff17,#ffffff0a);box-shadow:inset 0 1px #ffffff0d,inset 0 0 1px #fff3;content:"";pointer-events:none}.imagePreviews .imagePreviewTweaks .button:hover:before{background:linear-gradient(to bottom,#ffffff1f,#ffffff0f)}.imagePreviews .imagePreviewTweaks .button:active:before{box-shadow:inset 0 1px 3px #0000004d;background:linear-gradient(to bottom,#ffffff0f,#fff0)}.imagePreviews .imagePreviewTweaks .button:active{transform:translate(1px,1px)}.imagePreviews .imagePreviewTweaks .button.active{opacity:1}.imagePreviews .imagePreviewTweaks label{text-transform:uppercase;padding:8px 10px;color:#ffffff80;line-height:21px}.imagePreviews .value{width:50px}.imagePreviews .value{position:static}.imagePreviews .bigPreview{width:100%;height:100%;overflow:hidden;position:relative;cursor:move}.imagePreviews .fullImage{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);max-width:98%;max-height:calc(100vh - 80px);border:1px solid rgba(255,255,255,.2);box-shadow:0 0 60px #0000004d,0 0 30px #0000004d;transform-origin:top left}.imagePreviews .thumbnails{display:flex;left:0;right:0;bottom:0;background:#111;padding:10px;justify-content:flex-start;border-bottom:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px inset #00000080;flex-direction:column;max-width:100px;gap:10px;width:100px}.imagePreviews .thumbnails .thumb{width:100%;opacity:.2;cursor:pointer;position:relative;height:100%}.imagePreviews .thumbnails .thumb:hover{opacity:.7}.imagePreviews .thumbnails .thumb.active{opacity:1}.imagePreviews .thumbnails .thumb img{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);border-radius:10px}.imagePreviews .thumbnails .smallImage{border-radius:5px;max-width:100%;max-height:100%;margin:0 auto;display:block}.imagePreviews .mosaicGrid{width:100%;height:100%;position:absolute;top:50%;left:50%;transform-origin:top left}.imagePreviews .mosaicGrid .inner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;display:flex;flex-direction:row;align-content:center;flex-wrap:wrap;justify-content:center}.imagePreviews .mosaicGrid .mosaicImage{display:inline-block;transform:none;box-shadow:0 0 60px #0000004d,0 0 30px #0000004d}.imagePreviews .mosaicGrid .mosaicImage img{width:100%;height:100%}.imagePreviews .zoom{font-size:20px;font-weight:700;position:absolute;top:16px;right:15px;text-shadow:2px 2px 4px rgba(0,0,0,.7);cursor:pointer!important;cursor:pointer}.imagePreviews .zoom:hover{transform:scale(1.1);filter:saturate(1)}.imagePreviews .zoom:active{transform:scale(.9)}.imagePreviews .flipbookFps{font-size:20px;font-weight:700;position:absolute;top:15px;right:100px;text-shadow:2px 2px 4px rgba(0,0,0,.7);cursor:pointer!important}.imagePreviews .flipbookFps label{margin-right:10px}.imagePreviews .flipbookFps input{background:transparent;color:#fff;border:0;background:#0003;padding:5px 3px;border-radius:5px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;border-right:0;font-size:11px;color:#fff9;line-height:10px;width:40px;position:relative;font-size:16px;top:-1px;margin-right:20px}.imagePreviews .flipbookFps input[type=checkbox]{vertical-align:top;min-width:15px;max-width:15px;min-height:15px;max-height:15px;background-color:#0003;display:inline-block;margin-right:.8vh;border-radius:100%;margin-top:.45vh;box-shadow:0 0 0 .1vh #fff3;padding:.5vh;-webkit-appearance:none;outline:none;position:relative;top:3px}.imagePreviews .flipbookFps input[type=checkbox]:hover{background-color:#ffffff1a}.imagePreviews .flipbookFps input[type=checkbox]:checked{background:#fff}.imagePreviews .flipbookFps input[type=checkbox]:disabled{opacity:.2}.mapeBar .tweaks .promptTweaker{background:#333;padding:5px 0 10px;border-radius:0 0 5px 5px;position:relative;top:-5px}.mapeBar .tweaks .promptTweaker *{box-sizing:border-box}.mapeBar .tweaks .promptTweaker .promptTweakerPrompts{max-height:calc(100vh - 310px);overflow:auto}.mapeBar .tweaks .promptTweaker .buttons{display:flex;padding:0 10px 10px}.mapeBar .tweaks .promptTweaker button{flex:auto;vertical-align:top;border:0;text-transform:uppercase;text-shadow:2px 2px 1px #000000;-webkit-user-select:none;user-select:none;position:relative;display:inline-block;color:#fff;border-top:1px solid #0f0f12;background:#0f0f0f;margin:2px;border-radius:4px;cursor:pointer;line-height:1;transition:color 1s;outline:none;white-space:nowrap;font-size:11px;height:23px;padding:5px 8px}.mapeBar .tweaks .promptTweaker button.active{background:#490000}.mapeBar .tweaks .promptTweaker button:before{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:4px;background:linear-gradient(to bottom,#ffffff17,#ffffff0a);box-shadow:inset 0 1px #ffffff0d,inset 0 0 1px #fff3;content:"";pointer-events:none}.mapeBar .tweaks .promptTweaker button:hover:before{background:linear-gradient(to bottom,#ffffff1f,#ffffff0f)}.mapeBar .tweaks .promptTweaker button:active:before{box-shadow:inset 0 1px 3px #0000004d;background:linear-gradient(to bottom,#ffffff0f,#fff0)}.mapeBar .tweaks .promptTweaker button:active{transform:translate(1px,1px)}.mapeBar .tweaks .promptTweaker button.remove{width:25px;padding:5px 8px}.mapeBar .tweaks .promptTweaker .prompt{display:flex;padding:0 5px}.mapeBar .tweaks .promptTweaker .prompt label{max-width:130px;min-width:130px;height:auto;line-height:1.5;padding:2px;border-radius:5px}.mapeBar .tweaks .promptTweaker .prompt .weight{padding:0 10px;line-height:26px;min-width:43px;max-width:43px}.mapeBar .tweaks .promptTweaker .prompt input[type=range]{-moz-appearance:none;appearance:none;-webkit-appearance:none}.mapeBar .tweaks .promptTweaker .prompt input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;height:10px;width:10px;border-radius:50%;background:#fff;margin-top:-3px;box-shadow:1px 1px 2px #00000080;cursor:pointer}.mapeBar .tweaks .promptTweaker .prompt input[type=range]::-webkit-slider-runnable-track{width:60%;height:5px;background:#fff3;border-radius:3rem;transition:all .5s;cursor:pointer}.mapeBar .tweaks .promptTweaker .prompt input[type=range]:hover::-webkit-slider-runnable-track{background:#ffffff4d}.mapeBar .tweaks .promptTweaker .prompt.tmp{opacity:.5}.mapeBar .tweaks .promptTweaker .prompt input[type=checkbox]{vertical-align:top;min-width:15px;max-width:15px;min-height:15px;max-height:15px;background-color:#0003;display:inline-block;margin-right:.8vh;border-radius:100%;margin-top:.45vh;box-shadow:0 0 0 .1vh #fff3;padding:.5vh;-webkit-appearance:none;outline:none}.mapeBar .tweaks .promptTweaker .prompt input[type=checkbox]:hover{background-color:#ffffff1a}.mapeBar .tweaks .promptTweaker .prompt input[type=checkbox]:checked{background:#fff}.mapeBar .tweaks .promptTweaker .prompt input[type=checkbox]:disabled{opacity:.2}.mapeBar .tweaks .promptTweaker .prompt .arrows{padding:3px 5px 3px 0;position:relative;top:0}.mapeBar .tweaks .promptTweaker .prompt .arrows .arrow{color:#fff3;font-size:12px;line-height:10px}.mapeBar .tweaks .promptTweaker .prompt .arrows .arrow.disabled{pointer-events:none;opacity:0}.mapeBar .tweaks .promptTweaker .prompt .arrows .arrow:hover{cursor:pointer;color:#ffffffe6}.settingsPopup{position:fixed;background:#333;top:30px;right:0;color:#fff;font-family:arial;min-width:500px;z-index:1111111111;box-shadow:0 10px 20px #0000004d;border:1px solid #444}.settingsPopup .close{cursor:pointer;position:absolute;top:10px;right:10px;filter:saturate(0)}.settingsPopup .close:hover{transform:scale(1.1);filter:saturate(1)}.settingsPopup .close:active{transform:scale(.9)}.settingsPopup .header{background:#0000004d;border-bottom:1px solid rgba(255,255,255,.1);font-size:20px;padding:10px 15px;text-transform:uppercase}.settingsPopup .modalContent{max-height:calc(100vh - 100px);overflow:auto}.settingsPopup .mapeSetting{display:flex;position:relative;padding:1px 0;margin:0 3px;z-index:1}.settingsPopup .mapeSetting .name{background:#0003;padding:8px 10px;border-radius:5px 0 0 5px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;border-right:0;font-size:11px;color:#fff9;line-height:10px;min-width:400px;line-height:1.5}.settingsPopup .mapeSetting input{padding:5px;height:22px;color:#fff;font-size:11px;width:100%;border:0;background:transparent;resize:none;font-family:monospace}.settingsPopup .mapeSetting input:focus,.settingsPopup .mapeSetting input:active{outline:1px solid transparent}.settingsPopup .mapeSetting input[type=checkbox]{vertical-align:top;min-width:15px;max-width:15px;min-height:15px;max-height:15px;background-color:#0003;display:inline-block;margin-right:.8vh;border-radius:100%;margin-top:.45vh;box-shadow:0 0 0 .1vh #fff3;padding:.5vh;-webkit-appearance:none;outline:none;margin:0 auto;display:block}.settingsPopup .mapeSetting input[type=checkbox]:hover{background-color:#ffffff1a}.settingsPopup .mapeSetting input[type=checkbox]:checked{background:#fff}.settingsPopup .mapeSetting input[type=checkbox]:disabled{opacity:.2}.settingsPopup .mapeSetting input:focus{color:#ffa}.settingsPopup .mapeSetting input[type=color]{margin:-15px 0 -10px;height:36px;position:relative;top:4px}.settingsPopup .mapeSetting .reset{padding:5px;filter:saturate(0)}.settingsPopup .mapeSetting .reset:hover{filter:saturate(1)}.settingsPopup .mapeSetting .value{width:100%;position:relative;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;background:#222;border-radius:0 5px 5px 0;padding:8px 10px}.helpPopup{position:fixed;background:#333;top:30px;right:0;color:#fff;font-family:arial;min-width:500px;z-index:1111111111;box-shadow:0 10px 20px #0000004d;border:1px solid #444}.helpPopup .close{cursor:pointer;position:absolute;top:10px;right:10px;filter:saturate(0)}.helpPopup .close:hover{transform:scale(1.1);filter:saturate(1)}.helpPopup .close:active{transform:scale(.9)}.helpPopup .header{background:#0000004d;border-bottom:1px solid rgba(255,255,255,.1);font-size:20px;padding:10px 15px;text-transform:uppercase}.helpPopup .modalContent{max-height:calc(100vh - 100px);overflow:auto}.helpPopup .modalContent{display:flex}.helpPopup .modalContent .help{padding:15px}.helpPopup .modalContent .help .video,.helpPopup .modalContent .help .image{width:720px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 20px #0009;background:#000c}.helpPopup .modalContent .help .info{border:1px solid rgba(255,255,255,.1);background:#0000001a;margin:10px 0;border-radius:10px;overflow:hidden}.helpPopup .modalContent .help .title{font-size:25px;padding:15px 20px;font-weight:700;text-transform:uppercase;background:#0003;border-bottom:1px solid rgba(255,255,255,.1)}.helpPopup .modalContent .help .text{max-width:720px;font-size:15px;line-height:1.5;padding:15px 20px;font-size:17px;color:#fffc}.helpPopup .modalContent .menu{background-color:#222;margin:0;padding:0}.helpPopup .modalContent .menu li{background:linear-gradient(to right,#0000001a,#0000 20%,#0000);border-left:1px solid #555;padding:10px 15px;list-style:none;color:#ffffff80;border-bottom:1px solid rgba(0,0,0,.2)}.helpPopup .modalContent .menu li:nth-child(odd){background:linear-gradient(to right,#0003,#0000001a 20%,#0000001a);border-bottom:1px solid rgba(0,0,0,.1)}.helpPopup .modalContent .menu li:hover{color:#fff;cursor:pointer}.helpPopup .modalContent .menu li.active{background:#333;color:#fff;box-shadow:6px 2px 6px #0003;border-left:1px solid transparent;border-top:1px solid rgba(255,255,255,.1);border-bottom:1px solid rgba(0,0,0,.1);background:linear-gradient(to right,#333,#424242 20%,#333)}.helpPopup .modalContent .menu li.active:first-child{border-top:0}.mapeConfirmPrompt{font-family:arial;position:fixed;padding:10px;background:#333;border-bottom:1px solid #444;font-size:13px;z-index:111;border-radius:10px;border:2px solid #555;box-shadow:0 0 20px #0003;transform:translate(-50%,-50%)}.mapeConfirmPrompt *{box-sizing:border-box}.mapeConfirmPrompt .title{white-space:nowrap;text-transform:uppercase;padding:0 0 5px;text-align:center}.mapeConfirmPrompt input{position:relative;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;background:#222;color:#fff;border-radius:5px;padding:8px 10px;width:100%}.mapeConfirmPrompt input:focus,.mapeConfirmPrompt input:active{outline:1px solid transparent}.mapeConfirmPrompt .suggestions{background:#333;border-bottom:1px solid #444;font-size:13px;z-index:111;border:2px solid #555;box-shadow:0 0 20px #0003;position:absolute;top:100%;left:0;right:0;border-radius:5px}.mapeConfirmPrompt .suggestions .suggestion{padding:5px}.mapeConfirmPrompt .suggestions .suggestion:nth-child(odd){background:#0000001a}.mapeConfirmPrompt .suggestions .suggestion:hover,.mapeConfirmPrompt .suggestions .suggestion.selected{color:#ffa;background:#0000004d;cursor:pointer}.warningsPopup{position:fixed;background:#333;top:30px;right:0;color:#fff;font-family:arial;min-width:500px;z-index:1111111111;box-shadow:0 10px 20px #0000004d;border:1px solid #444}.warningsPopup .close{cursor:pointer;position:absolute;top:10px;right:10px;filter:saturate(0)}.warningsPopup .close:hover{transform:scale(1.1);filter:saturate(1)}.warningsPopup .close:active{transform:scale(.9)}.warningsPopup .header{background:#0000004d;border-bottom:1px solid rgba(255,255,255,.1);font-size:20px;padding:10px 15px;text-transform:uppercase}.warningsPopup .modalContent{max-height:calc(100vh - 100px);overflow:auto}.warningsPopup .mapeSetting{display:flex;position:relative;padding:4px 0;margin:0 3px;z-index:1}.warningsPopup .mapeSetting .name{background:#0003;padding:8px 10px;border-radius:5px 0 0 5px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;border-right:0;font-size:11px;color:#fff;line-height:10px;line-height:1.5;width:100%;font-size:16px}.warningsPopup .mapeSetting .name small{padding:0 10px;color:#fff9}.warningsPopup .mapeSetting button{flex:auto;vertical-align:top;border:0;text-transform:uppercase;text-shadow:2px 2px 1px #000000;-webkit-user-select:none;user-select:none;position:relative;display:inline-block;color:#fff;border-top:1px solid #0f0f12;background:#0f0f0f;margin:2px;border-radius:4px;cursor:pointer;line-height:1;transition:color 1s;outline:none;padding:0 10px;white-space:nowrap}.warningsPopup .mapeSetting button.active{background:#490000}.warningsPopup .mapeSetting button:before{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:4px;background:linear-gradient(to bottom,#ffffff17,#ffffff0a);box-shadow:inset 0 1px #ffffff0d,inset 0 0 1px #fff3;content:"";pointer-events:none}.warningsPopup .mapeSetting button:hover:before{background:linear-gradient(to bottom,#ffffff1f,#ffffff0f)}.warningsPopup .mapeSetting button:active:before{box-shadow:inset 0 1px 3px #0000004d;background:linear-gradient(to bottom,#ffffff0f,#fff0)}.warningsPopup .mapeSetting button:active{transform:translate(1px,1px)}@media only screen and (max-height: 850px){html body .comfy-menu{top:30px!important}}.mapeRoot *{box-sizing:border-box;font-family:arial;-webkit-user-select:none;user-select:none}.mapeRoot *::-webkit-scrollbar{width:5px;height:5px;background:linear-gradient(to right,#111,#222)}.mapeRoot *::-webkit-scrollbar-thumb{background:linear-gradient(to bottom,#fff,#aaa);border:1px solid #fff;border-radius:10px}.mapeBar{position:fixed;top:0;left:0;right:0;height:30px;background:#333;border-bottom:1px solid #444;display:flex;font-size:13px;z-index:1111111;border-top:1px solid rgba(255,255,255,.1);background:linear-gradient(to bottom,#353535,#313131 30%,#333)}.mapeBar:after{content:"";display:block;position:absolute;top:100%;left:0;right:0;height:20px;background:linear-gradient(to bottom,#0000002f,#0000);border-top:2px solid rgba(0,0,0,.3);pointer-events:none}.mapeBar .logo{background:url(https://comfyui.ma.pe/logo.svg);background-size:contain;background-repeat:no-repeat;min-width:26px;max-width:26px;margin:8px;cursor:pointer}.mapeBar .logo:hover{transform:scale(1.1);filter:saturate(1)}.mapeBar .logo:active{transform:scale(.9)}.mapeBar .tweakHighlight{position:relative}.mapeBar .tweakHighlight.siblingActive{opacity:.1}.mapeBar .tweakHighlight.active{opacity:1}.mapeBar .tweaks{display:flex}.mapeBar .tweaks .tweak{display:flex;position:relative;padding:4px 0;margin:0 3px;z-index:1}.mapeBar .tweaks .tweak label{background:#0003;padding:5px 8px;height:22px;border-radius:5px 0 0 5px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;border-right:0;font-size:11px;color:#fff9;line-height:10px}.mapeBar .tweaks .tweak label.interactable{cursor:pointer}.mapeBar .tweaks .tweak label.interactable:hover{color:#fff}.mapeBar .tweaks .tweak.defaultContainer label{border-radius:5px}.mapeBar .tweaks .tweak input,.mapeBar .tweaks .tweak textarea{padding:5px;height:22px;color:#fff;font-size:11px;width:100%;border:0;background:transparent;resize:none;font-family:monospace}.mapeBar .tweaks .tweak input:focus,.mapeBar .tweaks .tweak textarea:focus,.mapeBar .tweaks .tweak input:active,.mapeBar .tweaks .tweak textarea:active{outline:1px solid transparent}.mapeBar .tweaks .tweak input:focus{color:#ffa}.mapeBar .tweaks .tweak .image{position:absolute;top:0;left:0;width:50px;height:50px;border-radius:5px;background:#000;background-size:contain;background-repeat:no-repeat;background-position:center center}.mapeBar .tweaks .tweak .value{width:70px;position:relative;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;background:#222;height:22px;border-radius:0 5px 5px 0}.mapeBar .tweaks .tweak.stringContainer.focused .value{width:450px}.mapeBar .tweaks .tweak.stringContainer.focused textarea{height:150px;padding:10px;line-height:1.5;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;background:#222}.mapeBar .tweaks .tweak.imageContainer{cursor:pointer}.mapeBar .tweaks .tweak.imageContainer .value{width:50px}.mapeBar .tweaks .tweak.imageContainer .missingImage{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#ffffff80;width:50px;text-align:center}.mapeBar .tweaks .tweak.imageContainer .missing{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:20px}.mapeBar .tweaks .tweak.imageContainer.focused{display:block;background:repeating-radial-gradient(#181818 0,#181818 4px,#1f1f1f 5px,#1f1f1f 5px);position:fixed;top:0;left:0;right:0;bottom:0;z-index:1000;margin:0;background-size:10px 10px}.mapeBar .tweaks .tweak.imageContainer.focused label{display:none}.mapeBar .tweaks .tweak.imageContainer.focused .value{position:static}.mapeBar .tweaks .tweak.imageContainer.focused .image{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%}.mapeBar .tweaks .tweak.imageContainer.focused.hasMultiple{top:150px}.mapeBar .tweaks .tweak.imageContainer .fullImage{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);max-width:98%;max-height:98%;border:1px solid rgba(255,255,255,.2);box-shadow:0 0 60px #0000004d,0 0 30px #0000004d}.mapeBar .tweaks .tweak.imageContainer .thumbnails{display:flex;position:absolute;height:150px;left:0;right:0;bottom:100%;background:#111;padding:10px;justify-content:space-around;border-bottom:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px inset #00000080}.mapeBar .tweaks .tweak.imageContainer .thumbnails .thumb{width:100%}.mapeBar .tweaks .tweak.imageContainer .thumbnails .smallImage{border-radius:5px;max-width:100%;max-height:100%;margin:0 auto;display:block}.mapeBar button{width:100px}.mapeBar .options{position:absolute;top:0;font-weight:900;color:#fff;line-height:28px;font-size:18px;background:linear-gradient(to bottom,#353535,#313131 30%,#333);display:flex;right:5px;height:29px;gap:5px;padding:0 5px;z-index:9}.mapeBar .options div{filter:saturate(.8);cursor:pointer}.mapeBar .options div:hover{transform:scale(1.1);filter:saturate(1)}.mapeBar .options div:active{transform:scale(.9)}.mapeBar .options div small{position:absolute;top:6px;left:12px;font-size:62%}@keyframes fadeInOut{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.mapeBar .options .blink{animation:fadeInOut 1s ease-in-out infinite}')),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
